<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Vince Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Vince Blog">
<meta property="og:url" content="https://page.uetty.com/page/3/index.html">
<meta property="og:site_name" content="Vince Blog">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vince Blog">
  
    <link rel="alternate" href="/atom.xml" title="Vince Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Vince Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/s" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q1" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q6" value="page.uetty.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-mysql-slave" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/30/mysql-slave/" class="article-date">
  <time datetime="2018-12-30T05:23:29.000Z" itemprop="datePublished">2018-12-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/30/mysql-slave/">MySQL主从同步配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>为了方便操作，这里使用docker</p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><ol>
<li><p>创建网桥 <code>docker network create nw-ms</code>  </p>
</li>
<li><p>主MySQL环境：<code>docker run -it --name=master --network=nw-ms --network-alias=master uetty/mysql:5.7.23</code>  </p>
</li>
<li><p><code>vim /etc/mysql/mysql.conf.d/mysqld.cnf</code>  添加两行  </p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server-id               = 1</span><br><span class="line">log_bin                 = /var/log/mysql/mysql-bin.log</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启MySQL <code>service mysql restart</code> </p>
</li>
<li><p>退出容器    <code>ctrl + p &amp;&amp; ctrl + q</code>  </p>
</li>
<li><p>从MySQL环境：<code>docker run -it --name=slave --network=nw-ms --network-alias=slave uetty/mysql:5.7.23</code>  </p>
</li>
<li><p><code>vim /etc/mysql/mysql.conf.d/mysqld.cnf</code>  添加两行<br><code>server-id               = 100</code><br><code>log_bin                 = /var/log/mysql/mysql-bin.log</code>  </p>
</li>
<li><p>修改从服务器UUID使其不跟主服务器一样（使用docker部署同一台机子上会出现uuid一样的情况）<code>vim /var/lib/mysql/auto.cnf</code>  </p>
</li>
<li><p>重启MySQL <code>service mysql restart</code> </p>
</li>
<li><p>退出容器 <code>ctrl + p &amp;&amp; ctrl + q</code>  </p>
</li>
</ol>
<h2 id="创建从服务器登陆主服务器账号并授权"><a href="#创建从服务器登陆主服务器账号并授权" class="headerlink" title="创建从服务器登陆主服务器账号并授权"></a>创建从服务器登陆主服务器账号并授权</h2><ol>
<li><p>进入主服务器 <code>docker exec -it master bash</code>  </p>
</li>
<li><p>登陆mysql：<code>mysql -uroot -p123456</code>  </p>
</li>
<li><p>创建账号并授权<br> <code>create user root@&#39;slave.nw-ms&#39; identified by &#39;123456&#39;;</code>  登陆用户ip限制根据需要随意放宽<br> <code>grant replication slave on *.* to &#39;root&#39;@&#39;slave.nw-ms&#39; identified by ‘123456’;</code><br> <code>flush privileges;</code></p>
</li>
<li><p>查看当前log文件名及位置作为同步起始点（保证主库停止更新的情况下，如果还有更新任务，应暂时锁表禁止更新<code>FLUSH TABLES WITH READ LOCK</code>，待主从库数据相同，并且记录下主库file和position之后再解除<code>UNLOCK TABLES;</code>）<br> <code>show master status;</code> 如下所示，记录下File和Position</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| mysql-bin.000001 |      752 |              |                  |                   |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br></pre></td></tr></table></figure>
</li>
<li><p>退出主服务器<code>ctrl + p &amp;&amp; ctrl + q</code>  </p>
</li>
</ol>
<h2 id="从服务器配置"><a href="#从服务器配置" class="headerlink" title="从服务器配置"></a>从服务器配置</h2><p>确保从服务器数据与主服务器相同</p>
<ol>
<li><p>进入从服务器 <code>docker exec -it slave bash</code>  </p>
</li>
<li><p>登陆mysql：<code>mysql -uroot -p123456</code>  </p>
</li>
<li><p>设置同步参数 <code>change master to master_host=&#39;master&#39;, master_user=&#39;root&#39;, master_password=&#39;123456&#39;, master_log_file=&#39;mysql-bin.000001&#39;, master_log_pos=752;</code>   注：此处<code>master_host</code>对应docker容器运行时的<code>--network-alias</code>，也可直接使用ip地址，<code>master_log_file</code>和<code>master_log_pos</code>即对应前面<code>show master status;</code>所显示的数据  </p>
</li>
<li><p>开始同步 <code>start slave;</code>  </p>
</li>
<li><p>验证是否成功 <code>show slave status\G</code>，查看列出的信息内的以下两个参数值是否不为NO，否则同步失败，若同步失败可关注<code>Last_IO_Error</code>参数找出同步失败原因</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Slave_IO_Running: Yes  </span><br><span class="line">Slave_SQL_Running: Yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后就可以在主库中写一些数据试试看了</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/12/30/mysql-slave/" data-id="ck5qhi0620010g0uk24mk2fj2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-dubbo-retry-policy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/15/dubbo-retry-policy/" class="article-date">
  <time datetime="2018-11-15T14:40:56.000Z" itemprop="datePublished">2018-11-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/15/dubbo-retry-policy/">dubbo启动时class not found org/apache/curator/RetryPolicy</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org/apache/curator/RetryPolicy</span><br><span class="line">	at com.alibaba.dubbo.remoting.zookeeper.curator.CuratorZookeeperTransporter.connect(CuratorZookeeperTransporter.java:27)</span><br><span class="line">	at com.alibaba.dubbo.remoting.zookeeper.ZookeeperTransporter$Adaptive.connect(ZookeeperTransporter$Adaptive.java)</span><br><span class="line">	at com.alibaba.dubbo.registry.zookeeper.ZookeeperRegistry.&lt;init&gt;(ZookeeperRegistry.java:69)</span><br><span class="line">	at com.alibaba.dubbo.registry.zookeeper.ZookeeperRegistryFactory.createRegistry(ZookeeperRegistryFactory.java:38)</span><br><span class="line">	at com.alibaba.dubbo.registry.support.AbstractRegistryFactory.getRegistry(AbstractRegistryFactory.java:96)</span><br><span class="line">	at com.alibaba.dubbo.registry.RegistryFactory$Adaptive.getRegistry(RegistryFactory$Adaptive.java)</span><br><span class="line">	at com.alibaba.dubbo.registry.integration.RegistryProtocol.getRegistry(RegistryProtocol.java:203)</span><br><span class="line">	at com.alibaba.dubbo.registry.integration.RegistryProtocol.export(RegistryProtocol.java:137)</span><br><span class="line">	at com.alibaba.dubbo.rpc.protocol.ProtocolFilterWrapper.export(ProtocolFilterWrapper.java:98)</span><br><span class="line">	at com.alibaba.dubbo.rpc.protocol.ProtocolListenerWrapper.export(ProtocolListenerWrapper.java:55)</span><br><span class="line">	at com.alibaba.dubbo.qos.protocol.QosProtocolWrapper.export(QosProtocolWrapper.java:60)</span><br><span class="line">	at com.alibaba.dubbo.rpc.Protocol$Adaptive.export(Protocol$Adaptive.java)</span><br><span class="line">	at com.alibaba.dubbo.config.ServiceConfig.doExportUrlsFor1Protocol(ServiceConfig.java:513)</span><br><span class="line">	at com.alibaba.dubbo.config.ServiceConfig.doExportUrls(ServiceConfig.java:358)</span><br><span class="line">	at com.alibaba.dubbo.config.ServiceConfig.doExport(ServiceConfig.java:317)</span><br><span class="line">	at com.alibaba.dubbo.config.ServiceConfig.export(ServiceConfig.java:216)</span><br><span class="line">	at com.alibaba.dubbo.config.spring.ServiceBean.export(ServiceBean.java:291)</span><br><span class="line">	at com.alibaba.dubbo.config.spring.ServiceBean.onApplicationEvent(ServiceBean.java:131)</span><br><span class="line">	at com.alibaba.dubbo.config.spring.ServiceBean.onApplicationEvent(ServiceBean.java:53)</span><br><span class="line">	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)</span><br><span class="line">	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)</span><br><span class="line">	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:398)</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:355)</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:882)</span><br><span class="line">	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:549)</span><br><span class="line">	at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:144)</span><br><span class="line">	at org.springframework.context.support.ClassPathXmlApplicationContext.&lt;init&gt;(ClassPathXmlApplicationContext.java:95)</span><br><span class="line">	at com.uetty.dbo.service.App.main(App.java:18)</span><br><span class="line">Caused by: java.lang.ClassNotFoundException: org.apache.curator.RetryPolicy</span><br><span class="line">	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)</span><br><span class="line">	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:338)</span><br><span class="line">	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)</span><br><span class="line">	... 29 more</span><br></pre></td></tr></table></figure>

<p>确保包含如下依赖，注意该依赖所依赖的的zookeeper的jar版本需与zookeeper服务器版本匹配，具体版本对应见zookeeper文档或者一个个版本调试一下试试（如果与zookeeper版本匹配问题会报KeeperErrorCode = Unimplemented错误）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;curator-framework&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/11/15/dubbo-retry-policy/" data-id="ck5qhi060000wg0ukzftjde94" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dubbo/">dubbo</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-shadowsocks-server" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/01/shadowsocks-server/" class="article-date">
  <time datetime="2018-10-01T06:12:30.000Z" itemprop="datePublished">2018-10-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/01/shadowsocks-server/">shadowsocks docker 镜像实现代理 - 服务端（搭建代理服务器）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>基于Ubuntu 18.04 / Ubuntu 16.04测试，这里记录的是代理服务器的搭建，需要有一台境外的linux(各种发行版本的都行，只要能安装docker)服务器<br>docker 安装见 <a href="https://blog.csdn.net/Vincent_Field/article/details/82086197" target="_blank" rel="noopener">https://blog.csdn.net/Vincent_Field/article/details/82086197</a></p>
<h2 id="镜像获取"><a href="#镜像获取" class="headerlink" title="镜像获取"></a>镜像获取</h2><hr>
<p>docker pull uetty/shadowsocks:server</p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><hr>
<h3 id="初次启动"><a href="#初次启动" class="headerlink" title="初次启动"></a>初次启动</h3><blockquote>
<ol>
<li>宿主机上运行启动容器命令：<br>docker run –net=host –name=socks -t uetty/shadowsocks:server<br>ctrl + c 退出</li>
<li>进入容器内部：<br>docker exec -it socks bash<br>修改 /etc/shadowsocks.json 文件(vim /etc/shadowsocks.json)：<br>按i键编辑文件<br>设置端口、密码（可设置多对）、以及加密方式(method)<br>保存(依次：ctrl + c  -&gt;  输入:wq  -&gt;  回车)</li>
<li>在容器内部运行命令：<br>ssserver -c /etc/shadowsocks.json -d start<br>退出容器，先后按下：<br>ctrl + p     ctrl + q<br>在本地电脑使用客户端连接该服务器尝试是否代理成功</li>
</ol>
</blockquote>
<h3 id="关闭代理方式（第二步根据需要选择）"><a href="#关闭代理方式（第二步根据需要选择）" class="headerlink" title="关闭代理方式（第二步根据需要选择）"></a>关闭代理方式（第二步根据需要选择）</h3><blockquote>
<ol>
<li>进入容器：<br>docker exec -it socks bash<br>执行停止命令：<br>ssserver -c /etc/shadowsocks.json -d stop</li>
</ol>
</blockquote>
<h3 id="重启服务器后重新启动代理（服务器较少需要重启的情况）"><a href="#重启服务器后重新启动代理（服务器较少需要重启的情况）" class="headerlink" title="重启服务器后重新启动代理（服务器较少需要重启的情况）"></a>重启服务器后重新启动代理（服务器较少需要重启的情况）</h3><blockquote>
<ol>
<li>docker start socks</li>
<li>docker exec -it socks bash</li>
<li>此时已进入容器中，执行：<br>ssserver -c /etc/shadowsocks.json -d start</li>
</ol>
</blockquote>
<h3 id="尝试使用客户端连接服务器端代理"><a href="#尝试使用客户端连接服务器端代理" class="headerlink" title="尝试使用客户端连接服务器端代理"></a>尝试使用客户端连接服务器端代理</h3><blockquote>
<p><a href="https://raw.githubusercontent.com/Uetty/uetty.github.io/master/blog/影梭Win.zip" target="_blank" rel="noopener">Windows系统客户端</a></p>
<p><a href="./2018-09-21_shadowsocks.md">Ubuntu系统客户端教程</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/10/01/shadowsocks-server/" data-id="ck5qhi05z000ug0ukk5x9ya86" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-shadowsocks-client" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/21/shadowsocks-client/" class="article-date">
  <time datetime="2018-09-21T15:39:07.000Z" itemprop="datePublished">2018-09-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/21/shadowsocks-client/">shadowsocks docker 镜像实现代理 - 客户端（Ubuntu电脑访问服务器使用代理）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>基于Ubuntu 18.04测试，这里记录的是Ubuntu客户端使用代理的方式，服务端搭建代理服务器的移步<br>docker 安装见 <a href="https://blog.csdn.net/Vincent_Field/article/details/82086197" target="_blank" rel="noopener">https://blog.csdn.net/Vincent_Field/article/details/82086197</a><br>Windows系统的话，已经有现成的软件（<a href="../static/MB18092101-1.zip">影梭Win.zip</a>），该教程也就没有意义了  </p>
<h2 id="镜像获取"><a href="#镜像获取" class="headerlink" title="镜像获取"></a>镜像获取</h2><hr>
<p>docker pull uetty/shadowsocks:client</p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><hr>
<h3 id="初次启动"><a href="#初次启动" class="headerlink" title="初次启动"></a>初次启动</h3><blockquote>
<ol>
<li>宿主机上运行启动容器命令：<br>docker run –net=host –name=socks -t uetty/shadowsocks:client<br>ctrl + c 退出</li>
<li>进入容器内部：<br>docker exec -it socks bash<br>修改 /etc/shadowsocks.json 文件(vim /etc/shadowsocks.json)：<br>按i键编辑文件<br>修改服务器地址、端口、密码、以及加密方式(method)<br>保存(依次：ctrl + c  -&gt;  输入:wq  -&gt;  回车)</li>
<li>在容器内部运行命令：<br>sslocal -c /etc/shadowsocks.json -d start<br>退出容器，先后按下：<br>ctrl + p     ctrl + q</li>
<li>在宿主机上操作：<br>依次进入：设置 -&gt; 网络 -&gt; 网络代理 -&gt; 手动 -&gt; socks主机那行：<br>主机地址填写： 127.0.0.1 端口填写： 1080 忽略主机行填写（默认值）： localhost, 127.0.0.0/8, ::1<br>关闭设置<br>在浏览器上尝试是否代理成功</li>
</ol>
</blockquote>
<h3 id="关闭代理方式（第二步根据需要选择）"><a href="#关闭代理方式（第二步根据需要选择）" class="headerlink" title="关闭代理方式（第二步根据需要选择）"></a>关闭代理方式（第二步根据需要选择）</h3><blockquote>
<ol>
<li><p>将网络代理手动重新改为禁用</p>
</li>
<li><p>进入容器：<br>docker exec -it socks bash<br>执行停止命令：<br>sslocal -c /etc/shadowsocks.json -d stop</p>
</li>
</ol>
</blockquote>
<h3 id="重启电脑后重新启动代理"><a href="#重启电脑后重新启动代理" class="headerlink" title="重启电脑后重新启动代理"></a>重启电脑后重新启动代理</h3><blockquote>
<ol>
<li><p>docker start socks</p>
</li>
<li><p>docker exec -it socks bash</p>
</li>
<li><p>此时已进入容器中，执行：<br>sslocal -c /etc/shadowsocks.json -d start</p>
</li>
<li><p>退出容器，设置中设置手动代理</p>
</li>
</ol>
</blockquote>
<h3 id="命令行下使用代理"><a href="#命令行下使用代理" class="headerlink" title="命令行下使用代理"></a>命令行下使用代理</h3><blockquote>
<ol>
<li><p>在宿主机上执行（从container中将已准备好的工具拷贝出来）：<br>docker cp socks:/data/proxychains-ng.tar ~/data/proxychains-ng.tar<br>拷贝出来的位置随意自己决定</p>
</li>
<li><p>解压<br>cd ~/data<br>tar xf proxychains-ng.tar</p>
</li>
<li><p>安装<br>./configure<br>make<br>sudo make install<br>sudo cp ./src/proxychains.conf /etc/proxychains.conf<br>cd .. &amp;&amp; rm -rf proxychains-ng</p>
</li>
<li><p>修改配置<br>sudo vim /etc/proxychains.conf<br>修改最后一行为：<br>socks5 127.0.0.1 1080</p>
</li>
<li><p>使用<br>在需要代理的命令前增加：sudo proxychains4<br>如：<br>sudo proxychains4 ping <a href="http://www.docker.com" target="_blank" rel="noopener">www.docker.com</a><br>或<br>sudo proxychains4 -q ping <a href="http://www.docker.com" target="_blank" rel="noopener">www.docker.com</a></p>
</li>
</ol>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/09/21/shadowsocks-client/" data-id="ck5qhi05y000sg0ukz4jy55t8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-shadowsocks" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/07/shadowsocks/" class="article-date">
  <time datetime="2018-09-07T15:44:29.000Z" itemprop="datePublished">2018-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/07/shadowsocks/">Ubuntu shadowsocks 客户端代理记录（本地端用ubuntu setting替代chrome浏览器插件）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>基于Ubuntu 18.04测试，这里记录的是Ubuntu客户端使用代理的方式，服务端搭建代理服务器的移步<br>Windows系统的话，已经有现成的软件（<a href="https://raw.githubusercontent.com/Uetty/uetty.github.io/master/blog/影梭Win.zip" target="_blank" rel="noopener">Windows系统客户端</a>），该教程也就没有意义了  </p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><hr>
<ul>
<li>sudo apt-get update</li>
<li>sudo apt-get install python-pip</li>
<li>sudo apt-get install shadowsocks</li>
<li>sudo vim /etc/shadowsocks.json</li>
</ul>
<p>输入以下内容后保存</p>
<blockquote>
<p>{<br>    “server”:”xx.xx.xx.xx”, // 远程服务器地址<br>    “server_port”:xxxx, // 远程服务器端口<br>    “local_address”: “127.0.0.1”, // 本机地址<br>    “local_port”:1080, // 本机用于代理的端口<br>    “password”:”xxxxx”, // 密码<br>    “timeout”:300, // 超时<br>    “method”:”aes-256-cfb”, // 加密方式<br>    “fast_open”: true,<br>    “workers”: 1<br>}</p>
</blockquote>
<p>sudo sslocal -c /etc/shadowsocks.json -d start      启动服务（以后可以通过这个命令启动socks服务）</p>
<h2 id="chrome浏览器代理"><a href="#chrome浏览器代理" class="headerlink" title="chrome浏览器代理"></a>chrome浏览器代理</h2><hr>
<p>打开操作系统的设置 -&gt; 网络 -&gt; 网络代理，选择手动代理，只需填两行，Socks主机：127.0.0.1  1080，忽略主机：localhost, 127.0.0.0/8, ::1，忽略主机项表示不经过代理的网站，还可以逗号补上不想被代理的地址，如：<a href="http://www.baidu.com等。这时浏览器就能通过代理加速访问需要访问的网站。" target="_blank" rel="noopener">www.baidu.com等。这时浏览器就能通过代理加速访问需要访问的网站。</a></p>
<h2 id="命令行终端代理"><a href="#命令行终端代理" class="headerlink" title="命令行终端代理"></a>命令行终端代理</h2><hr>
<p>前面的设置下，命令行终端并没有经过代理。需要经过以下步骤进行：</p>
<ul>
<li>git clone <a href="https://github.com/rofl0r/proxychains-ng.git" target="_blank" rel="noopener">https://github.com/rofl0r/proxychains-ng.git</a></li>
<li>cd proxychains-ng</li>
<li>./configure</li>
<li>make</li>
<li>sudo make install</li>
<li>sudo cp ./src/proxychains.conf /etc/proxychains.conf</li>
<li>cd .. &amp;&amp; rm -rf proxychains-ng       (根据需要选择删除原来的安装源码)</li>
<li>sudo vim /etc/proxychains.conf       修改最后一行为：socks5  127.0.0.1 1080</li>
</ul>
<p>这时候，命令行终端如果需要经过代理，可以在命令前面添加：sudo proxychains4 指令，如果不想输出proxychains的日志信息可以使用：sudo proxychains4 -q，如：</p>
<blockquote>
<p>添加docker ppa时，由于网络问题，原来的命令<br>sudo add-apt-repository “deb [arch=amd64] <a href="https://download.docker.com/linux/ubuntu" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu</a> $(lsb_release -cs) stable”<br>不能成功执行，这时命令修改成：<br>sudo proxychains4 add-apt-repository “deb [arch=amd64] <a href="https://download.docker.com/linux/ubuntu" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu</a> $(lsb_release -cs) stable”<br>使得该命令的网络经过代理，可以成功完成</p>
<p>还可以：<br>sudo proxychains4 ping <a href="http://www.docker.com" target="_blank" rel="noopener">www.docker.com</a><br>sudo proxychains4 apt-get update<br>sudo proxychains4 -q apt-cache madison mysql-server       (-q 安静模式，不输出proxychains4的日志)<br>sudo proxychains4 apt-get install mysql-server</p>
</blockquote>
<p>参考自：<a href="https://blog.csdn.net/lee_j_r/article/details/54019691" target="_blank" rel="noopener">https://blog.csdn.net/lee_j_r/article/details/54019691</a><br>主要不同点： chrome浏览器代理（修改理由：在没有代理之前，不能打开插件市场安装管理插件，因此修改了代理方式）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/09/07/shadowsocks/" data-id="ck5qhi05x000qg0ukum9thxpz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/28/docker/" class="article-date">
  <time datetime="2018-08-28T12:55:08.000Z" itemprop="datePublished">2018-08-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/28/docker/">DOCKER一键入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>base Ubuntu 16.04</p>
<h1 id="入门操作"><a href="#入门操作" class="headerlink" title="入门操作"></a>入门操作</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol>
<li><code>sudo apt-get remove docker docker-engine docker-ce docker.io</code> </li>
<li><code>sudo apt-get update</code> </li>
<li><code>sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common</code>  （使apt能接受https的ppa库） </li>
<li><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code>       （docker官方GPG密钥）</li>
<li><code>sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;</code>     （ppa库，这个地址好像不是很好用，在某些网络下会失败，成功率与各自网络有关。出现网络问题的话，有条件的同学可以考虑科学上网）</li>
<li><code>sudo apt-get update</code></li>
<li><code>sudo apt-get install -y docker-ce</code>      (安装最新版)<br>如果不想要最新版：<br><code>apt-cache madison docker-ce</code>       （查看版本列表）<br><code>sudo apt-get install docker-ce=&lt;VERSION&gt;</code>      （指定版本安装）  </li>
</ol>
<h2 id="创建docker用户组"><a href="#创建docker用户组" class="headerlink" title="创建docker用户组"></a>创建docker用户组</h2><p><code>sudo groupadd docker</code>            （应该不需要执行，已经有了）<br><code>sudo usermod -aG docker $USER</code>     （将当前用户添加到附加组群docker）<br>重新登录用户账户使生效</p>
<h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p><code>systemctl status docker</code>     （启动状态）<br><code>sudo systemctl start docker</code>    （启动，或 <code>sudo service docker start</code>）<br><code>sudo docker run hello-world</code>     （官方提供hello world程序）  </p>
<h2 id="创建镜像并运行生成容器"><a href="#创建镜像并运行生成容器" class="headerlink" title="创建镜像并运行生成容器"></a>创建镜像并运行生成容器</h2><p>新建名称为Dockerfile的文件（无后缀名），输入如下内容并保存： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:16.04</span><br><span class="line"></span><br><span class="line">RUN \</span><br><span class="line">    apt-get update &amp;&amp;\</span><br><span class="line">    apt-get install -y openjdk-8-jdk &amp;&amp;\</span><br><span class="line">    rm -rf /var/lib/apt/lists/*</span><br><span class="line"></span><br><span class="line">ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64</span><br><span class="line">ENV LANG C.UTF-8</span><br><span class="line"></span><br><span class="line">CMD [&quot;/bin/bash&quot;]</span><br></pre></td></tr></table></figure>

<p>文件中，继承了ubuntu的docker镜像(ubuntu:16.04)的16.04版本<br>在该目录下直接执行以下命令新建镜像：<br><code>docker build -t mytest/jdk:1.8 .</code>        （运行过程较长。不要漏了最后的点，最后那个点代表当前目录，倒二参数镜像名可任意设置，-t 为tag）<br><code>docker images</code>            可看到mytest/jdk:1.8已进入现有镜像列表中<br><code>docker run -p 80:8080 -it mytest/jdk:1.8</code>          启动docker镜像新建立一个容器（-p 表示将主机80端口映射到容器内部的8080端口，此例中端口映射没有什么意义，只是为了说明，–name=myname ：手动分配名字，-t 伪tty终端，-d 守护进程的方式后台执行（默认交互进程方式），CMD为.需要保持tty终端连接的运行命令时需要-d否则sh执行完docker就退出了），如果Dockerfile中没有定义命令CMD运行不成功，这时可在docker run的最后面添加运行命令手动指定<br>运行成功后，在容器内输入命令：java -version 可看到jdk已经安装成功  </p>
<h1 id="模块化知识点"><a href="#模块化知识点" class="headerlink" title="模块化知识点"></a>模块化知识点</h1><h2 id="docker概念"><a href="#docker概念" class="headerlink" title="docker概念"></a>docker概念</h2><p>Docker客户端        命令行允许时给客户端发送命令，客户端分发到指定容器<br>Docker Daemon 守护进程        docker允许依赖的进程<br>Docker Image 镜像        docker启动前需要指定之前制作的镜像（即源码，只读模式）<br>Docker Container 容器        docker运行镜像的拷贝于虚拟机上（运行后的镜像为叫容器，即镜像的实例，读写模式），可对其停止运行，重新运行，内部命令操作，修改后重新打包为新镜像，一个镜像可运行为多个容器<br>Docker Registry 仓库        docker镜像存储的位置，有公有仓库与私有仓库<br>交互式容器与守护式容器        交互式容器：当前命令进程执行完毕容器即退出；守护式容器：当前命令进程与该进程启动的进程都运行完毕才退出，通常没有交互式程序时使用  </p>
<h2 id="容器停止与启动"><a href="#容器停止与启动" class="headerlink" title="容器停止与启动"></a>容器停止与启动</h2><p><code>docker stop 8d43</code>            停止正在运行的容器（发出结束的信号，8d43为通过docker ps 查看到的name前面几个字符，stop时name无须填完整，只要docker能识别不引起歧义就行）<br><code>docker start -i 8d43</code>            重新运行容器（-i 标准输入始终打开）<br><code>docker kill 8d43</code>            快速强制停止容器  </p>
<h2 id="容器与镜像的删除"><a href="#容器与镜像的删除" class="headerlink" title="容器与镜像的删除"></a>容器与镜像的删除</h2><p><code>docker rm 8d43</code>            删除已经停止的容器（需先停止容器）<br><code>docker rmi uettydkr/test:1.0</code>            删除镜像(需先删除该镜像的所有容器实例)  </p>
<h2 id="容器网络设置"><a href="#容器网络设置" class="headerlink" title="容器网络设置"></a>容器网络设置</h2><h3 id="端口映射"><a href="#端口映射" class="headerlink" title="端口映射"></a>端口映射</h3><p><code>docker run -P -i -t uettydkr/test:1.0</code>            对容器暴露的所有端口进行映射<br><code>docker run -p 8080 -i -t uettydkr/test:1.0</code>            指定容器8080端口映射到宿主机的随机端口<br><code>docker run -p 80:8080 -i -t uettydkr/test:1.0</code>            容器的8080端口映射到宿主机的80端口<br><code>docker run -p 0.0.0.0:8080 -i -t uettydkr/test:1.0</code>            指定容器ip和容器的端口<br><code>docker run -p 0.0.0.0:80:8080 -i -t uettydkr/test:1.0</code>            指定容器ip，容器8080端口映射到宿主机的80端口<br><code>docker port 8d43</code>            查看端口映射情况<br><code>docker run --net=host -i -t uettydkr/test:1.0</code>             –net=host 将使容器与宿主机共用端口（较少使用），可能导致容器内新启动的程序的端口会与宿主机发生冲突  </p>
<h3 id="使用bridge-utils进行网桥操作"><a href="#使用bridge-utils进行网桥操作" class="headerlink" title="使用bridge-utils进行网桥操作"></a>使用bridge-utils进行网桥操作</h3><p>安装：<code>sudo apt-get install bridge-utils</code><br>验证：<code>sudo brctl show</code><br>添加一个新的网桥：<code>sudo brctl addbr mybr0 &amp;&amp; sudo ifconfig mybr0 192.168.200.1 netmask 255.255.255.0</code>  </p>
<h3 id="网络地址"><a href="#网络地址" class="headerlink" title="网络地址"></a>网络地址</h3><p>修改dockers网络地址ip网段：<code>sudo ifconfig docker0 192.168.192.1 netmask 255.255.255.0 &amp;&amp; sudo service docker restart</code><br>修改docker使用的网桥为mybr0：<br><code>vim /etc/default/docker</code><br>在DOCKER_OPTS中添加参数 <code>DOCKER_OPTS=&quot; -b=mybr0 &quot;</code>，重启docker service  </p>
<h3 id="容器互联LINK方式"><a href="#容器互联LINK方式" class="headerlink" title="容器互联LINK方式"></a>容器互联LINK方式</h3><p>默认是允许所有容器互相连接<br>使用给容器ip地址设置别名（不设置别名的情况下，默认设置下通过ip实际也能访问），避免重启ip变化：<br>容器1：<code>docker run -it --name=c1 ubuntu:16.04</code><br>容器2连接容器1：<code>docker run -it --name=c2 --link=c1:host1 ubuntu:16.04</code>     在容器2内部输入命令env或者cat /etc/hosts可看到影响情况<br>修改默认互联规则为拒绝：DOCKER_OPTS中添加 –icc=false ，重启docker service<br>特定容器连接：DOCKER_OPTS中添加 –icc=false外，还需要 –iptables=true 让docker容器把配置添加到iptables设置中，并且容器需用–link选项，需先将iptables的设置清空（sudo iptables -F），并且重启启动docker，查看iptables设置（<code>sudo iptables -L -n</code>）  </p>
<h3 id="容器互联BRIDGE方式"><a href="#容器互联BRIDGE方式" class="headerlink" title="容器互联BRIDGE方式"></a>容器互联BRIDGE方式</h3><p>创建一个网桥：<code>docker network create mysql-ms</code><br>指定网桥及网络别名启动<br><code>docker run -it --name=mysql-m1 --network=mysql-ms --network-alias=mysql-m1 uetty/mysql:5.7.23</code><br><code>docker run -it --name=mysql-s1 --network=mysql-ms --network-alias=mysql-s1 uetty/mysql:5.7.23</code>  </p>
<h3 id="容器与外部网络连接"><a href="#容器与外部网络连接" class="headerlink" title="容器与外部网络连接"></a>容器与外部网络连接</h3><p>默认是允许与外部网络连接<br>通过<code>sudo sysctl net.ipv4.conf.all.forwarding</code>可查看系统ipforward值<br>设置禁止容器与外部网络连接DOCKER_OPTS添加 –ip-forward=false，重启docker service<br>设置容器(172.17.0.2)80端口不被特定ip(111.11.11.11)访问（通过iptables）：<code>sudo iptables -I DOCKER -s 111.11.11.11 -d 172.17.0.2 -p TCP --dport 80 -j DROP</code>  </p>
<h2 id="远程镜像仓库"><a href="#远程镜像仓库" class="headerlink" title="远程镜像仓库"></a>远程镜像仓库</h2><p><a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a>           docker官方仓库地址<br><code>docker search ubuntu</code>             –automated=false true时只选中自动化构建出的镜像；–no-trunc=false true时不以截断的方式输出；-s或–stars=0 限制显示结果的最低星级<br><code>docker pull ubuntu:14.04</code>            从远程拉取镜像<br><code>docker login</code>           登陆远程镜像仓库，之后会提示输入账户和密码<br><code>docker push uetty/test:1.0</code>            将镜像push到远程镜像仓库（须在docker hub创建有账户，并创建这个仓库，本地执行过登陆）  </p>
<p>修改镜像仓库镜像地址加速拉取： 1. 修改： <code>/etc/default/docker</code>；2. 添加 <code>DOCKER_OPTS=&quot;--registry-mirror=http://MIRROR-ADDR&quot;</code><br>国内可以选择daocloud.io 注册账号后选择加速器生成链接：如：<a href="http://ae6fed91.m.daocloud.io" target="_blank" rel="noopener">http://ae6fed91.m.daocloud.io</a>  </p>
<h2 id="构建自己的镜像"><a href="#构建自己的镜像" class="headerlink" title="构建自己的镜像"></a>构建自己的镜像</h2><h3 id="通过commit容器的方式构建镜像"><a href="#通过commit容器的方式构建镜像" class="headerlink" title="通过commit容器的方式构建镜像"></a>通过commit容器的方式构建镜像</h3><ol>
<li>先从公共镜像仓库中拉曲一个ubuntu镜像：<code>docker pull ubuntu:16.04</code>  </li>
<li>使用该镜像启动一个容器：<code>docker run -d --name ubuntu-nginx ubuntu:16.04 /bin/bash</code>  </li>
<li>进入容器：<code>docker exec -it ubuntu-nginx /bin/bash</code>  </li>
<li>安装自己的软件(nginx)：<code>apt-get update &amp;&amp; apt-get install nginx</code>  </li>
<li>安装完毕后退出容器：<code>ctrl + p &amp;&amp; ctrl + q</code>  </li>
<li>提交容器生成镜像：<code>docker commit -a &quot;uetty&quot; -m &quot;nginx&quot; b9fa70 uetty/nginx</code>            生成镜像名为uetty/nginx（-a 作者信息；-m 镜像信息描述）  </li>
<li>接下来有需要的话可以把镜像提交到远程仓库中<h3 id="通过Dockerfile的方式构建镜像"><a href="#通过Dockerfile的方式构建镜像" class="headerlink" title="通过Dockerfile的方式构建镜像"></a>通过Dockerfile的方式构建镜像</h3>前面入门操作-&gt;创建镜像并运行生成容器 中已经介绍  </li>
</ol>
<h2 id="远程访问"><a href="#远程访问" class="headerlink" title="远程访问"></a>远程访问</h2><p>需保证Client API与Server API版本一致，修改启动选项区别服务器  </p>
<h3 id="服务端（server-1）环境"><a href="#服务端（server-1）环境" class="headerlink" title="服务端（server_1）环境"></a>服务端（server_1）环境</h3><p>修改启动选项<code>sudo vim /etc/default/docker</code>，输入<br><code>DOCKER_OPTS=&quot; --label name=docker_server_1 -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock&quot;</code>    –label给服务器上标签，通过docker info可看到label值，-H 接受三种形式：tcp://host:port，unix:///path/to/socket（默认），fd://* or fd://socketfd，-H 可指定多个，为了保证本地客户端不被影响应加上unix方式<br><code>sudo service docker restart</code>     重启生效<br><code>curl http://xx.xx.xx.xx:2375/info</code>            检测<br><code>docker -H tcp://xx.xx.xx.xx:2375 info</code>    客户端访问  </p>
<h3 id="客户端-server-2-远程连接"><a href="#客户端-server-2-远程连接" class="headerlink" title="客户端(server_2)远程连接"></a>客户端(server_2)远程连接</h3><p>另一台服务器<br><code>export DOCKER_HOST=&quot;tcp://xx.xx.xx.xx:2375&quot;</code>       默认连接到远程服务端<br><code>docker info</code>            可以从这里看到这时访问到远程服务端<br><code>export DOCKER_HOST=&quot;&quot;</code>            取消默认远程客户端  </p>
<h2 id="与宿主机进行地址映射与文件拷贝"><a href="#与宿主机进行地址映射与文件拷贝" class="headerlink" title="与宿主机进行地址映射与文件拷贝"></a>与宿主机进行地址映射与文件拷贝</h2><p><code>docker run -d -v /data/volumes/ubuntu:/data --name ubuntu-nginx ubuntu:16.04 /bin/bash</code>        将宿主机的/data/volumes/ubuntu 目录映射到容器/data目录<br><code>docker cp ubuntu-nginx:/a.txt a.txt</code>             将容器内a.txt文件拷贝到宿主机<br>创建数据卷容器，并将数据卷容器挂载给其他容器<br><code>docker run -it -v /var/lib/mysql --name mysql-data ubuntu:16.04 /bin/bash</code>           创建数据卷容器<br><code>docker run -it --volumes-from mysql-data --name mysql uetty/mysql:5.7.23 /bin/bash</code>        挂载数据卷容器  </p>
<h2 id="其他操作命令一览"><a href="#其他操作命令一览" class="headerlink" title="其他操作命令一览"></a>其他操作命令一览</h2><p><code>docker ps</code>                        查看各镜像状态（无参数：列出运行的容器，-a：列出所有的容器，-l：列出最后运行的容器）<br><code>docker exec -it 8d43 /bin/bash</code>            容器中启动新进程，异步方式进入docker容器命令行（如果容器构建使用的是/bin/sh，最后一个参数换成/bin/sh）<br><code>docker images</code>            可看到uettydkr/test:1.0已进入现有镜像列表中<br><code>docker attach 8d43</code>           附加到docker容器，同步方式进入容器命令行（如果某个客户端阻塞了，该方式进入也会被阻塞，因此不推荐）<br><code>docker inspect 8d43</code>            列出容器json格式信息<br><code>ctrl+p &amp;&amp; ctrl+q</code>            退出交互式容器，容器不会停止运行（即先后按下<code>ctrl + p</code> <code>ctrl + q</code>两个命令）<br><code>docker logs 8d43</code>            返回日志（默认返回所有日志，-f：持续返回日志，-t：返回的日志增加时间戳，–tail 10 指定显示最新的10条日志）<br><code>docker top 8d43</code>            查看运行中容器的进程情况<br><code>docker info</code>            查看docker信息，包括镜像存储位置<br><code>docker search java</code>        从远程镜像仓库查找镜像  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/08/28/docker/" data-id="ck5qhi070002ig0ukqanry1rg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ubuntu-wps" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/09/ubuntu-wps/" class="article-date">
  <time datetime="2018-06-09T03:27:38.000Z" itemprop="datePublished">2018-06-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/09/ubuntu-wps/">Ubuntu下wps开多个窗口（不是标签页）的方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案"><a href="#方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案" class="headerlink" title="方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案"></a>方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案</h2><p>左上角按钮 -&gt; 进入选项 -&gt; 勾选 在任务栏中显示所有按钮选择框 -&gt; 最后确定</p>
<p>该方案缺点是单个窗口只能开一个标签页</p>
<h2 id="方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）"><a href="#方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）" class="headerlink" title="方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）"></a>方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）</h2><p>word文档：<code>nohup /opt/kingsoft/wps-office/office6/wps -multiply &gt; /dev/null 2&gt;&amp;1 &amp;</code><br>excel文档：<code>nohup /opt/kingsoft/wps-office/office6/et -multiply &gt; /dev/null 2&gt;&amp;1 &amp;</code><br>ppt文档：<code>nohup /opt/kingsoft/wps-office/office6/wpp -multiply &gt; /dev/null 2&gt;&amp;1 &amp;</code></p>
<p>为了方便以后使用，可以将命令加入.bashrc文件（注意最后是两个大于号，漏写一个会出大问题，建议复制粘贴）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo alias wps-word=&apos;nohup /opt/kingsoft/wps-office/office6/wps -multiply &gt; /dev/null 2&gt;&amp;1 &amp;&apos; &gt;&gt; ~/.bashrc</span><br><span class="line">echo alias wps-excel=&apos;nohup /opt/kingsoft/wps-office/office6/et -multiply &gt; /dev/null 2&gt;&amp;1 &amp;&apos; &gt;&gt; ~/.bashrc</span><br><span class="line">echo alias wps-ppt=&apos;nohup /opt/kingsoft/wps-office/office6/wpp -multiply &gt; /dev/null 2&gt;&amp;1 &amp;&apos; &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>使当前命令行及机器上.bashrc生效需执行，否则重启后生效<br><code>source ~/.bashrc</code></p>
<p>下次直接在命令行中使用<br><code>wps-word</code>、<code>wps-excel</code>、<code>wps-ppt</code>命令即可</p>
<p>该方案缺点是操作麻烦</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/06/09/ubuntu-wps/" data-id="ck5qhi05v000ng0ukqfs107r1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mybatis-pager" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/24/mybatis-pager/" class="article-date">
  <time datetime="2018-03-24T01:47:31.000Z" itemprop="datePublished">2018-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/24/mybatis-pager/">MyBatis分页配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.1.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;</span><br><span class="line">        &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;com.xxx.xxx.vo&quot;/&gt;</span><br><span class="line">        &lt;property name=&quot;plugins&quot;&gt;</span><br><span class="line">            &lt;array&gt;</span><br><span class="line">                &lt;bean class=&quot;com.github.pagehelper.PageHelper&quot;&gt;</span><br><span class="line">                    &lt;property name=&quot;properties&quot;&gt;</span><br><span class="line">                        &lt;value&gt;</span><br><span class="line">                            dialect=mysql</span><br><span class="line">                            offsetAsPageNum=true</span><br><span class="line">                            rowBoundsWithCount=true</span><br><span class="line">                        &lt;/value&gt;</span><br><span class="line">                    &lt;/property&gt;</span><br><span class="line">                &lt;/bean&gt;</span><br><span class="line">            &lt;/array&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.startPage(pageNum, pageSize); // pageNum 下标从1开始</span><br><span class="line">Page&lt;Data&gt; page = dao.searchList(form); // sql中不写limit</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/03/24/mybatis-pager/" data-id="ck5qhi05m000ig0ukzdw5av76" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MyBatis/">MyBatis</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-transaction-isolation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/10/transaction-isolation/" class="article-date">
  <time datetime="2018-03-10T04:13:59.000Z" itemprop="datePublished">2018-03-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/10/transaction-isolation/">事务的隔离级别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="事务的ACID特性"><a href="#事务的ACID特性" class="headerlink" title="事务的ACID特性"></a>事务的ACID特性</h2><ol>
<li>原子性 </li>
<li>一致性（事务处理前后从一个一致性状态变换到另一个一致性状态） </li>
<li>隔离性（多个并发事务间的隔离） </li>
<li>持久性 </li>
</ol>
<h2 id="无隔离处理下的几种问题"><a href="#无隔离处理下的几种问题" class="headerlink" title="无隔离处理下的几种问题"></a>无隔离处理下的几种问题</h2><h3 id="1-脏读"><a href="#1-脏读" class="headerlink" title="1. 脏读"></a>1. 脏读</h3><p>并发的其中一个事务读取另一个事务未提交的内容，当另一个事务回滚后发现读的是无效数据 </p>
<h3 id="2-不可重复读"><a href="#2-不可重复读" class="headerlink" title="2. 不可重复读"></a>2. 不可重复读</h3><p>并发的其中一个事务在一开始读取了一次数据，并在另一个事务提交后又读取了一次数据，发现两次读取的数据不一致 </p>
<h3 id="3-幻读（虚读）"><a href="#3-幻读（虚读）" class="headerlink" title="3. 幻读（虚读）"></a>3. 幻读（虚读）</h3><p>并发的其中一条事务对表内的所有行执行字段a的值从1变为2，这时在另一条事务中在表内添加了另一条a的值为1的数据，前一条事务会发现执行完后，表内仍有a字段值为1的记录 </p>
<h2 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h2><p>针对上述问题，设置了四种事务的隔离级别，由用户根据业务选择使用哪种隔离级别 ，在MySQL中默认是Repeatable Read级别，Oracle中默认是Read Committed级别。</p>
<h3 id="1-读未提交-READ-UNCOMMITTED"><a href="#1-读未提交-READ-UNCOMMITTED" class="headerlink" title="1. 读未提交(READ UNCOMMITTED)"></a>1. 读未提交(READ UNCOMMITTED)</h3><p>可以读到其他事务未提交的数据。 </p>
<h3 id="2-读已提交-READ-COMMITTED"><a href="#2-读已提交-READ-COMMITTED" class="headerlink" title="2. 读已提交(READ COMMITTED)"></a>2. 读已提交(READ COMMITTED)</h3><p>只能读到其他事务已提交的数据。 </p>
<h3 id="3-可重复读-REPEATABLE-READ"><a href="#3-可重复读-REPEATABLE-READ" class="headerlink" title="3. 可重复读(REPEATABLE READ)"></a>3. 可重复读(REPEATABLE READ)</h3><p>在读已提交的基础上，增加一点，本条事务内，读同一份数据，以该事务第一次读取的数据的备份为标准（即使在此期间其他事务提交了该数据的修改，读到的仍是原数据）。 </p>
<h3 id="4-串行-SERIALIZABLE"><a href="#4-串行-SERIALIZABLE" class="headerlink" title="4. 串行(SERIALIZABLE)"></a>4. 串行(SERIALIZABLE)</h3><p>串行执行，该事务不能与其他事务同时操作同一个数据，必须等待操作数据的事务或串行事务提交才能继续运行。Serializable的事务先查询或修改了该条记录，则其他事务对该记录的操作均会被阻塞。 </p>
<p>事务隔离会在写数据的时候给数据加上排他锁，而串行事务下读数据的时候也会给数据加上排他锁。 </p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>查看当前事务隔离级别  <code>SELECT @@TX_ISOLATION</code></p>
<p>设置当前事务隔离级别  <code>SET SESSION TRANSACTION ISOLATION LEVEL read uncommitted / read committed / repeatable read / serializable</code></p>
<p>Spring中注解设置 <code>@Transactional(isolation = Isolation.REPEATABLE_READ)</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/03/10/transaction-isolation/" data-id="ck5qhi05u000lg0ukhdoj7p68" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spring-autowire-resolver" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/25/spring-autowire-resolver/" class="article-date">
  <time datetime="2018-02-25T07:20:10.000Z" itemprop="datePublished">2018-02-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/25/spring-autowire-resolver/">SpringMVC自定义配置自动注入对象</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>继承org.springframework.web.method.support.HandlerMethodArgumentResolver的类test.UserArgumentResolver</li>
<li>配置文件配置参数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:annotation-driven&gt;</span><br><span class="line">    &lt;mvc:argument-resolvers&gt;</span><br><span class="line">    	&lt;bean class=&quot;com.xxx.UserArgumentResolver&quot;/&gt;</span><br><span class="line">    &lt;/mvc:argument-resolvers&gt;</span><br><span class="line">&lt;/mvc:annotation-driven&gt;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://page.uetty.com/2018/02/25/spring-autowire-resolver/" data-id="ck5qhi05n000jg0ukkviu78r0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDE/">IDE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyBatis/">MyBatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/">RabbitMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api/">api</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/encoding/">encoding</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j/">log4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/open-source/">open source</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnerability/">vulnerability</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图论/">图论</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/IDE/" style="font-size: 10px;">IDE</a> <a href="/tags/MyBatis/" style="font-size: 10px;">MyBatis</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/api/" style="font-size: 12px;">api</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/encoding/" style="font-size: 10px;">encoding</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/linux/" style="font-size: 18px;">linux</a> <a href="/tags/log4j/" style="font-size: 10px;">log4j</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/mysql/" style="font-size: 14px;">mysql</a> <a href="/tags/open-source/" style="font-size: 10px;">open source</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/spring/" style="font-size: 16px;">spring</a> <a href="/tags/vulnerability/" style="font-size: 10px;">vulnerability</a> <a href="/tags/图论/" style="font-size: 10px;">图论</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">2020-02</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">2020-01</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">2019-12</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">2019-11</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">2019-08</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">2019-07</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">2019-06</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">2019-05</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">2019-04</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">2019-03</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">2019-02</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">2018-12</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">2018-11</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">2018-10</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">2018-09</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">2018-08</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">2018-06</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">2018-03</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">2018-02</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">2017-12</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">2017-09</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">2017-08</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">2017-07</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">2017-05</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">2017-03</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/23/character-set-encoding/">从二分图开始到最大匹配</a>
          </li>
        
          <li>
            <a href="/2020/02/13/character-set-encoding/">理解字符集编码及Java内存编码运行机制</a>
          </li>
        
          <li>
            <a href="/2020/01/08/gitlab-api/">Gitlab Api</a>
          </li>
        
          <li>
            <a href="/2019/12/11/source-bitcount/">JDK中Integer.bitCount解析</a>
          </li>
        
          <li>
            <a href="/2019/11/25/linux-cgroup-cpu/">Linux限制进程CPU上限</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Vince<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>
<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Vince Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Vince Blog">
<meta property="og:url" content="https://www.uetty.com/page/3/index.html">
<meta property="og:site_name" content="Vince Blog">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vince Blog">
  
    <link rel="alternate" href="/atom.xml" title="Vince Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Vince Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/s" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q1" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="q6" value="www.uetty.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-shadowsocks" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/07/shadowsocks/" class="article-date">
  <time datetime="2018-09-07T15:44:29.000Z" itemprop="datePublished">2018-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/07/shadowsocks/">Ubuntu shadowsocks 客户端代理记录（本地端用ubuntu setting替代chrome浏览器插件）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>基于Ubuntu 18.04测试，这里记录的是Ubuntu客户端使用代理的方式，服务端搭建代理服务器的移步<br>Windows系统的话，已经有现成的软件（<a href="https://raw.githubusercontent.com/Uetty/uetty.github.io/master/blog/影梭Win.zip" target="_blank" rel="noopener">Windows系统客户端</a>），该教程也就没有意义了  </p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><hr>
<ul>
<li>sudo apt-get update</li>
<li>sudo apt-get install python-pip</li>
<li>sudo apt-get install shadowsocks</li>
<li>sudo vim /etc/shadowsocks.json</li>
</ul>
<p>输入以下内容后保存</p>
<blockquote>
<p>{<br>    “server”:”xx.xx.xx.xx”, // 远程服务器地址<br>    “server_port”:xxxx, // 远程服务器端口<br>    “local_address”: “127.0.0.1”, // 本机地址<br>    “local_port”:1080, // 本机用于代理的端口<br>    “password”:”xxxxx”, // 密码<br>    “timeout”:300, // 超时<br>    “method”:”aes-256-cfb”, // 加密方式<br>    “fast_open”: true,<br>    “workers”: 1<br>}</p>
</blockquote>
<p>sudo sslocal -c /etc/shadowsocks.json -d start      启动服务（以后可以通过这个命令启动socks服务）</p>
<h2 id="chrome浏览器代理"><a href="#chrome浏览器代理" class="headerlink" title="chrome浏览器代理"></a>chrome浏览器代理</h2><hr>
<p>打开操作系统的设置 -&gt; 网络 -&gt; 网络代理，选择手动代理，只需填两行，Socks主机：127.0.0.1  1080，忽略主机：localhost, 127.0.0.0/8, ::1，忽略主机项表示不经过代理的网站，还可以逗号补上不想被代理的地址，如：<a href="http://www.baidu.com等。这时浏览器就能通过代理加速访问需要访问的网站。" target="_blank" rel="noopener">www.baidu.com等。这时浏览器就能通过代理加速访问需要访问的网站。</a></p>
<h2 id="命令行终端代理"><a href="#命令行终端代理" class="headerlink" title="命令行终端代理"></a>命令行终端代理</h2><hr>
<p>前面的设置下，命令行终端并没有经过代理。需要经过以下步骤进行：</p>
<ul>
<li>git clone <a href="https://github.com/rofl0r/proxychains-ng.git" target="_blank" rel="noopener">https://github.com/rofl0r/proxychains-ng.git</a></li>
<li>cd proxychains-ng</li>
<li>./configure</li>
<li>make</li>
<li>sudo make install</li>
<li>sudo cp ./src/proxychains.conf /etc/proxychains.conf</li>
<li>cd .. &amp;&amp; rm -rf proxychains-ng       (根据需要选择删除原来的安装源码)</li>
<li>sudo vim /etc/proxychains.conf       修改最后一行为：socks5  127.0.0.1 1080</li>
</ul>
<p>这时候，命令行终端如果需要经过代理，可以在命令前面添加：sudo proxychains4 指令，如果不想输出proxychains的日志信息可以使用：sudo proxychains4 -q，如：</p>
<blockquote>
<p>添加docker ppa时，由于网络问题，原来的命令<br>sudo add-apt-repository “deb [arch=amd64] <a href="https://download.docker.com/linux/ubuntu" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu</a> $(lsb_release -cs) stable”<br>不能成功执行，这时命令修改成：<br>sudo proxychains4 add-apt-repository “deb [arch=amd64] <a href="https://download.docker.com/linux/ubuntu" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu</a> $(lsb_release -cs) stable”<br>使得该命令的网络经过代理，可以成功完成</p>
<p>还可以：<br>sudo proxychains4 ping <a href="http://www.docker.com" target="_blank" rel="noopener">www.docker.com</a><br>sudo proxychains4 apt-get update<br>sudo proxychains4 -q apt-cache madison mysql-server       (-q 安静模式，不输出proxychains4的日志)<br>sudo proxychains4 apt-get install mysql-server</p>
</blockquote>
<p>参考自：<a href="https://blog.csdn.net/lee_j_r/article/details/54019691" target="_blank" rel="noopener">https://blog.csdn.net/lee_j_r/article/details/54019691</a><br>主要不同点： chrome浏览器代理（修改理由：在没有代理之前，不能打开插件市场安装管理插件，因此修改了代理方式）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2018/09/07/shadowsocks/" data-id="ck3jtbley000xqsuojeowwkrj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/28/docker/" class="article-date">
  <time datetime="2018-08-28T12:55:08.000Z" itemprop="datePublished">2018-08-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/28/docker/">DOCKER一键入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>base Ubuntu 16.04</p>
<h1 id="入门操作"><a href="#入门操作" class="headerlink" title="入门操作"></a>入门操作</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ol>
<li><code>sudo apt-get remove docker docker-engine docker-ce docker.io</code> </li>
<li><code>sudo apt-get update</code> </li>
<li><code>sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common</code>  （使apt能接受https的ppa库） </li>
<li><code>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code>       （docker官方GPG密钥）</li>
<li><code>sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;</code>     （ppa库，这个地址好像不是很好用，在某些网络下会失败，成功率与各自网络有关。出现网络问题的话，有条件的同学可以考虑科学上网）</li>
<li><code>sudo apt-get update</code></li>
<li><code>sudo apt-get install -y docker-ce</code>      (安装最新版)<br>如果不想要最新版：<br><code>apt-cache madison docker-ce</code>       （查看版本列表）<br><code>sudo apt-get install docker-ce=&lt;VERSION&gt;</code>      （指定版本安装）  </li>
</ol>
<h2 id="创建docker用户组"><a href="#创建docker用户组" class="headerlink" title="创建docker用户组"></a>创建docker用户组</h2><p><code>sudo groupadd docker</code>            （应该不需要执行，已经有了）<br><code>sudo usermod -aG docker $USER</code>     （将当前用户添加到附加组群docker）<br>重新登录用户账户使生效</p>
<h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p><code>systemctl status docker</code>     （启动状态）<br><code>sudo systemctl start docker</code>    （启动，或 <code>sudo service docker start</code>）<br><code>sudo docker run hello-world</code>     （官方提供hello world程序）  </p>
<h2 id="创建镜像并运行生成容器"><a href="#创建镜像并运行生成容器" class="headerlink" title="创建镜像并运行生成容器"></a>创建镜像并运行生成容器</h2><p>新建名称为Dockerfile的文件（无后缀名），输入如下内容并保存： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:16.04</span><br><span class="line"></span><br><span class="line">RUN \</span><br><span class="line">    apt-get update &amp;&amp;\</span><br><span class="line">    apt-get install -y openjdk-8-jdk &amp;&amp;\</span><br><span class="line">    rm -rf /var/lib/apt/lists/*</span><br><span class="line"></span><br><span class="line">ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64</span><br><span class="line">ENV LANG C.UTF-8</span><br><span class="line"></span><br><span class="line">CMD [&quot;/bin/bash&quot;]</span><br></pre></td></tr></table></figure>

<p>文件中，继承了ubuntu的docker镜像(ubuntu:16.04)的16.04版本<br>在该目录下直接执行以下命令新建镜像：<br><code>docker build -t mytest/jdk:1.8 .</code>        （运行过程较长。不要漏了最后的点，最后那个点代表当前目录，倒二参数镜像名可任意设置，-t 为tag）<br><code>docker images</code>            可看到mytest/jdk:1.8已进入现有镜像列表中<br><code>docker run -p 80:8080 -it mytest/jdk:1.8</code>          启动docker镜像新建立一个容器（-p 表示将主机80端口映射到容器内部的8080端口，此例中端口映射没有什么意义，只是为了说明，–name=myname ：手动分配名字，-t 伪tty终端，-d 守护进程的方式后台执行（默认交互进程方式），CMD为.需要保持tty终端连接的运行命令时需要-d否则sh执行完docker就退出了），如果Dockerfile中没有定义命令CMD运行不成功，这时可在docker run的最后面添加运行命令手动指定<br>运行成功后，在容器内输入命令：java -version 可看到jdk已经安装成功  </p>
<h1 id="模块化知识点"><a href="#模块化知识点" class="headerlink" title="模块化知识点"></a>模块化知识点</h1><h2 id="docker概念"><a href="#docker概念" class="headerlink" title="docker概念"></a>docker概念</h2><p>Docker客户端        命令行允许时给客户端发送命令，客户端分发到指定容器<br>Docker Daemon 守护进程        docker允许依赖的进程<br>Docker Image 镜像        docker启动前需要指定之前制作的镜像（即源码，只读模式）<br>Docker Container 容器        docker运行镜像的拷贝于虚拟机上（运行后的镜像为叫容器，即镜像的实例，读写模式），可对其停止运行，重新运行，内部命令操作，修改后重新打包为新镜像，一个镜像可运行为多个容器<br>Docker Registry 仓库        docker镜像存储的位置，有公有仓库与私有仓库<br>交互式容器与守护式容器        交互式容器：当前命令进程执行完毕容器即退出；守护式容器：当前命令进程与该进程启动的进程都运行完毕才退出，通常没有交互式程序时使用  </p>
<h2 id="容器停止与启动"><a href="#容器停止与启动" class="headerlink" title="容器停止与启动"></a>容器停止与启动</h2><p><code>docker stop 8d43</code>            停止正在运行的容器（发出结束的信号，8d43为通过docker ps 查看到的name前面几个字符，stop时name无须填完整，只要docker能识别不引起歧义就行）<br><code>docker start -i 8d43</code>            重新运行容器（-i 标准输入始终打开）<br><code>docker kill 8d43</code>            快速强制停止容器  </p>
<h2 id="容器与镜像的删除"><a href="#容器与镜像的删除" class="headerlink" title="容器与镜像的删除"></a>容器与镜像的删除</h2><p><code>docker rm 8d43</code>            删除已经停止的容器（需先停止容器）<br><code>docker rmi uettydkr/test:1.0</code>            删除镜像(需先删除该镜像的所有容器实例)  </p>
<h2 id="容器网络设置"><a href="#容器网络设置" class="headerlink" title="容器网络设置"></a>容器网络设置</h2><h3 id="端口映射"><a href="#端口映射" class="headerlink" title="端口映射"></a>端口映射</h3><p><code>docker run -P -i -t uettydkr/test:1.0</code>            对容器暴露的所有端口进行映射<br><code>docker run -p 8080 -i -t uettydkr/test:1.0</code>            指定容器8080端口映射到宿主机的随机端口<br><code>docker run -p 80:8080 -i -t uettydkr/test:1.0</code>            容器的8080端口映射到宿主机的80端口<br><code>docker run -p 0.0.0.0:8080 -i -t uettydkr/test:1.0</code>            指定容器ip和容器的端口<br><code>docker run -p 0.0.0.0:80:8080 -i -t uettydkr/test:1.0</code>            指定容器ip，容器8080端口映射到宿主机的80端口<br><code>docker port 8d43</code>            查看端口映射情况<br><code>docker run --net=host -i -t uettydkr/test:1.0</code>             –net=host 将使容器与宿主机共用端口（较少使用），可能导致容器内新启动的程序的端口会与宿主机发生冲突  </p>
<h3 id="使用bridge-utils进行网桥操作"><a href="#使用bridge-utils进行网桥操作" class="headerlink" title="使用bridge-utils进行网桥操作"></a>使用bridge-utils进行网桥操作</h3><p>安装：<code>sudo apt-get install bridge-utils</code><br>验证：<code>sudo brctl show</code><br>添加一个新的网桥：<code>sudo brctl addbr mybr0 &amp;&amp; sudo ifconfig mybr0 192.168.200.1 netmask 255.255.255.0</code>  </p>
<h3 id="网络地址"><a href="#网络地址" class="headerlink" title="网络地址"></a>网络地址</h3><p>修改dockers网络地址ip网段：<code>sudo ifconfig docker0 192.168.192.1 netmask 255.255.255.0 &amp;&amp; sudo service docker restart</code><br>修改docker使用的网桥为mybr0：<br><code>vim /etc/default/docker</code><br>在DOCKER_OPTS中添加参数 <code>DOCKER_OPTS=&quot; -b=mybr0 &quot;</code>，重启docker service  </p>
<h3 id="容器互联LINK方式"><a href="#容器互联LINK方式" class="headerlink" title="容器互联LINK方式"></a>容器互联LINK方式</h3><p>默认是允许所有容器互相连接<br>使用给容器ip地址设置别名（不设置别名的情况下，默认设置下通过ip实际也能访问），避免重启ip变化：<br>容器1：<code>docker run -it --name=c1 ubuntu:16.04</code><br>容器2连接容器1：<code>docker run -it --name=c2 --link=c1:host1 ubuntu:16.04</code>     在容器2内部输入命令env或者cat /etc/hosts可看到影响情况<br>修改默认互联规则为拒绝：DOCKER_OPTS中添加 –icc=false ，重启docker service<br>特定容器连接：DOCKER_OPTS中添加 –icc=false外，还需要 –iptables=true 让docker容器把配置添加到iptables设置中，并且容器需用–link选项，需先将iptables的设置清空（sudo iptables -F），并且重启启动docker，查看iptables设置（<code>sudo iptables -L -n</code>）  </p>
<h3 id="容器互联BRIDGE方式"><a href="#容器互联BRIDGE方式" class="headerlink" title="容器互联BRIDGE方式"></a>容器互联BRIDGE方式</h3><p>创建一个网桥：<code>docker network create mysql-ms</code><br>指定网桥及网络别名启动<br><code>docker run -it --name=mysql-m1 --network=mysql-ms --network-alias=mysql-m1 uetty/mysql:5.7.23</code><br><code>docker run -it --name=mysql-s1 --network=mysql-ms --network-alias=mysql-s1 uetty/mysql:5.7.23</code>  </p>
<h3 id="容器与外部网络连接"><a href="#容器与外部网络连接" class="headerlink" title="容器与外部网络连接"></a>容器与外部网络连接</h3><p>默认是允许与外部网络连接<br>通过<code>sudo sysctl net.ipv4.conf.all.forwarding</code>可查看系统ipforward值<br>设置禁止容器与外部网络连接DOCKER_OPTS添加 –ip-forward=false，重启docker service<br>设置容器(172.17.0.2)80端口不被特定ip(111.11.11.11)访问（通过iptables）：<code>sudo iptables -I DOCKER -s 111.11.11.11 -d 172.17.0.2 -p TCP --dport 80 -j DROP</code>  </p>
<h2 id="远程镜像仓库"><a href="#远程镜像仓库" class="headerlink" title="远程镜像仓库"></a>远程镜像仓库</h2><p><a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a>           docker官方仓库地址<br><code>docker search ubuntu</code>             –automated=false true时只选中自动化构建出的镜像；–no-trunc=false true时不以截断的方式输出；-s或–stars=0 限制显示结果的最低星级<br><code>docker pull ubuntu:14.04</code>            从远程拉取镜像<br><code>docker login</code>           登陆远程镜像仓库，之后会提示输入账户和密码<br><code>docker push uetty/test:1.0</code>            将镜像push到远程镜像仓库（须在docker hub创建有账户，并创建这个仓库，本地执行过登陆）  </p>
<p>修改镜像仓库镜像地址加速拉取： 1. 修改： <code>/etc/default/docker</code>；2. 添加 <code>DOCKER_OPTS=&quot;--registry-mirror=http://MIRROR-ADDR&quot;</code><br>国内可以选择daocloud.io 注册账号后选择加速器生成链接：如：<a href="http://ae6fed91.m.daocloud.io" target="_blank" rel="noopener">http://ae6fed91.m.daocloud.io</a>  </p>
<h2 id="构建自己的镜像"><a href="#构建自己的镜像" class="headerlink" title="构建自己的镜像"></a>构建自己的镜像</h2><h3 id="通过commit容器的方式构建镜像"><a href="#通过commit容器的方式构建镜像" class="headerlink" title="通过commit容器的方式构建镜像"></a>通过commit容器的方式构建镜像</h3><ol>
<li>先从公共镜像仓库中拉曲一个ubuntu镜像：<code>docker pull ubuntu:16.04</code>  </li>
<li>使用该镜像启动一个容器：<code>docker run -d --name ubuntu-nginx ubuntu:16.04 /bin/bash</code>  </li>
<li>进入容器：<code>docker exec -it ubuntu-nginx /bin/bash</code>  </li>
<li>安装自己的软件(nginx)：<code>apt-get update &amp;&amp; apt-get install nginx</code>  </li>
<li>安装完毕后退出容器：<code>ctrl + p &amp;&amp; ctrl + q</code>  </li>
<li>提交容器生成镜像：<code>docker commit -a &quot;uetty&quot; -m &quot;nginx&quot; b9fa70 uetty/nginx</code>            生成镜像名为uetty/nginx（-a 作者信息；-m 镜像信息描述）  </li>
<li>接下来有需要的话可以把镜像提交到远程仓库中<h3 id="通过Dockerfile的方式构建镜像"><a href="#通过Dockerfile的方式构建镜像" class="headerlink" title="通过Dockerfile的方式构建镜像"></a>通过Dockerfile的方式构建镜像</h3>前面入门操作-&gt;创建镜像并运行生成容器 中已经介绍  </li>
</ol>
<h2 id="远程访问"><a href="#远程访问" class="headerlink" title="远程访问"></a>远程访问</h2><p>需保证Client API与Server API版本一致，修改启动选项区别服务器  </p>
<h3 id="服务端（server-1）环境"><a href="#服务端（server-1）环境" class="headerlink" title="服务端（server_1）环境"></a>服务端（server_1）环境</h3><p>修改启动选项<code>sudo vim /etc/default/docker</code>，输入<br><code>DOCKER_OPTS=&quot; --label name=docker_server_1 -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock&quot;</code>    –label给服务器上标签，通过docker info可看到label值，-H 接受三种形式：tcp://host:port，unix:///path/to/socket（默认），fd://* or fd://socketfd，-H 可指定多个，为了保证本地客户端不被影响应加上unix方式<br><code>sudo service docker restart</code>     重启生效<br><code>curl http://xx.xx.xx.xx:2375/info</code>            检测<br><code>docker -H tcp://xx.xx.xx.xx:2375 info</code>    客户端访问  </p>
<h3 id="客户端-server-2-远程连接"><a href="#客户端-server-2-远程连接" class="headerlink" title="客户端(server_2)远程连接"></a>客户端(server_2)远程连接</h3><p>另一台服务器<br><code>export DOCKER_HOST=&quot;tcp://xx.xx.xx.xx:2375&quot;</code>       默认连接到远程服务端<br><code>docker info</code>            可以从这里看到这时访问到远程服务端<br><code>export DOCKER_HOST=&quot;&quot;</code>            取消默认远程客户端  </p>
<h2 id="与宿主机进行地址映射与文件拷贝"><a href="#与宿主机进行地址映射与文件拷贝" class="headerlink" title="与宿主机进行地址映射与文件拷贝"></a>与宿主机进行地址映射与文件拷贝</h2><p><code>docker run -d -v /data/volumes/ubuntu:/data --name ubuntu-nginx ubuntu:16.04 /bin/bash</code>        将宿主机的/data/volumes/ubuntu 目录映射到容器/data目录<br><code>docker cp ubuntu-nginx:/a.txt a.txt</code>             将容器内a.txt文件拷贝到宿主机<br>创建数据卷容器，并将数据卷容器挂载给其他容器<br><code>docker run -it -v /var/lib/mysql --name mysql-data ubuntu:16.04 /bin/bash</code>           创建数据卷容器<br><code>docker run -it --volumes-from mysql-data --name mysql uetty/mysql:5.7.23 /bin/bash</code>        挂载数据卷容器  </p>
<h2 id="其他操作命令一览"><a href="#其他操作命令一览" class="headerlink" title="其他操作命令一览"></a>其他操作命令一览</h2><p><code>docker ps</code>                        查看各镜像状态（无参数：列出运行的容器，-a：列出所有的容器，-l：列出最后运行的容器）<br><code>docker exec -it 8d43 /bin/bash</code>            容器中启动新进程，异步方式进入docker容器命令行（如果容器构建使用的是/bin/sh，最后一个参数换成/bin/sh）<br><code>docker images</code>            可看到uettydkr/test:1.0已进入现有镜像列表中<br><code>docker attach 8d43</code>           附加到docker容器，同步方式进入容器命令行（如果某个客户端阻塞了，该方式进入也会被阻塞，因此不推荐）<br><code>docker inspect 8d43</code>            列出容器json格式信息<br><code>ctrl+p &amp;&amp; ctrl+q</code>            退出交互式容器，容器不会停止运行（即先后按下<code>ctrl + p</code> <code>ctrl + q</code>两个命令）<br><code>docker logs 8d43</code>            返回日志（默认返回所有日志，-f：持续返回日志，-t：返回的日志增加时间戳，–tail 10 指定显示最新的10条日志）<br><code>docker top 8d43</code>            查看运行中容器的进程情况<br><code>docker info</code>            查看docker信息，包括镜像存储位置<br><code>docker search java</code>        从远程镜像仓库查找镜像  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2018/08/28/docker/" data-id="ck3jtbleu000uqsuope8riptm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ubuntu-wps" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/09/ubuntu-wps/" class="article-date">
  <time datetime="2018-06-09T03:27:38.000Z" itemprop="datePublished">2018-06-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/09/ubuntu-wps/">Ubuntu下wps开多个窗口（不是标签页）的方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案"><a href="#方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案" class="headerlink" title="方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案"></a>方案一、如果没有既要开多个窗口，又要单个窗口开多个标签页的需求的话，可以采用该方案</h2><p>左上角按钮 -&gt; 进入选项 -&gt; 勾选 在任务栏中显示所有按钮选择框 -&gt; 最后确定</p>
<p>该方案缺点是单个窗口只能开一个标签页</p>
<h2 id="方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）"><a href="#方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）" class="headerlink" title="方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）"></a>方案二、使用命令行启动一个空的wps界面，之后再在界面上打开文件（利用在命令中加上-multiply参数的方法）</h2><p>word文档：<code>nohup /opt/kingsoft/wps-office/office6/wps -multiply &gt; /dev/null 2&gt;&amp;1 &amp;</code><br>excel文档：<code>nohup /opt/kingsoft/wps-office/office6/et -multiply &gt; /dev/null 2&gt;&amp;1 &amp;</code><br>ppt文档：<code>nohup /opt/kingsoft/wps-office/office6/wpp -multiply &gt; /dev/null 2&gt;&amp;1 &amp;</code></p>
<p>为了方便以后使用，可以将命令加入.bashrc文件（注意最后是两个大于号，漏写一个会出大问题，建议复制粘贴）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo alias wps-word=&apos;nohup /opt/kingsoft/wps-office/office6/wps -multiply &gt; /dev/null 2&gt;&amp;1 &amp;&apos; &gt;&gt; ~/.bashrc</span><br><span class="line">echo alias wps-excel=&apos;nohup /opt/kingsoft/wps-office/office6/et -multiply &gt; /dev/null 2&gt;&amp;1 &amp;&apos; &gt;&gt; ~/.bashrc</span><br><span class="line">echo alias wps-ppt=&apos;nohup /opt/kingsoft/wps-office/office6/wpp -multiply &gt; /dev/null 2&gt;&amp;1 &amp;&apos; &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>使当前命令行及机器上.bashrc生效需执行，否则重启后生效<br><code>source ~/.bashrc</code></p>
<p>下次直接在命令行中使用<br><code>wps-word</code>、<code>wps-excel</code>、<code>wps-ppt</code>命令即可</p>
<p>该方案缺点是操作麻烦</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2018/06/09/ubuntu-wps/" data-id="ck3jtblew000vqsuovzd2ta3j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mybatis-pager" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/24/mybatis-pager/" class="article-date">
  <time datetime="2018-03-24T01:47:31.000Z" itemprop="datePublished">2018-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/24/mybatis-pager/">MyBatis分页配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;4.1.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;</span><br><span class="line">        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;</span><br><span class="line">        &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;com.xxx.xxx.vo&quot;/&gt;</span><br><span class="line">        &lt;property name=&quot;plugins&quot;&gt;</span><br><span class="line">            &lt;array&gt;</span><br><span class="line">                &lt;bean class=&quot;com.github.pagehelper.PageHelper&quot;&gt;</span><br><span class="line">                    &lt;property name=&quot;properties&quot;&gt;</span><br><span class="line">                        &lt;value&gt;</span><br><span class="line">                            dialect=mysql</span><br><span class="line">                            offsetAsPageNum=true</span><br><span class="line">                            rowBoundsWithCount=true</span><br><span class="line">                        &lt;/value&gt;</span><br><span class="line">                    &lt;/property&gt;</span><br><span class="line">                &lt;/bean&gt;</span><br><span class="line">            &lt;/array&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.startPage(pageNum, pageSize); // pageNum 下标从1开始</span><br><span class="line">Page&lt;Data&gt; page = dao.searchList(form); // sql中不写limit</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2018/03/24/mybatis-pager/" data-id="ck3jtblep000rqsuoqn7iuesn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MyBatis/">MyBatis</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-transaction-isolation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/03/10/transaction-isolation/" class="article-date">
  <time datetime="2018-03-10T04:13:59.000Z" itemprop="datePublished">2018-03-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/03/10/transaction-isolation/">事务的隔离级别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="事务的ACID特性"><a href="#事务的ACID特性" class="headerlink" title="事务的ACID特性"></a>事务的ACID特性</h2><ol>
<li>原子性 </li>
<li>一致性（事务处理前后从一个一致性状态变换到另一个一致性状态） </li>
<li>隔离性（多个并发事务间的隔离） </li>
<li>持久性 </li>
</ol>
<h2 id="无隔离处理下的几种问题"><a href="#无隔离处理下的几种问题" class="headerlink" title="无隔离处理下的几种问题"></a>无隔离处理下的几种问题</h2><h3 id="1-脏读"><a href="#1-脏读" class="headerlink" title="1. 脏读"></a>1. 脏读</h3><p>并发的其中一个事务读取另一个事务未提交的内容，当另一个事务回滚后发现读的是无效数据 </p>
<h3 id="2-不可重复读"><a href="#2-不可重复读" class="headerlink" title="2. 不可重复读"></a>2. 不可重复读</h3><p>并发的其中一个事务在一开始读取了一次数据，并在另一个事务提交后又读取了一次数据，发现两次读取的数据不一致 </p>
<h3 id="3-幻读（虚读）"><a href="#3-幻读（虚读）" class="headerlink" title="3. 幻读（虚读）"></a>3. 幻读（虚读）</h3><p>并发的其中一条事务对表内的所有行执行字段a的值从1变为2，这时在另一条事务中在表内添加了另一条a的值为1的数据，前一条事务会发现执行完后，表内仍有a字段值为1的记录 </p>
<h2 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h2><p>针对上述问题，设置了四种事务的隔离级别，由用户根据业务选择使用哪种隔离级别 ，在MySQL中默认是Repeatable Read级别，Oracle中默认是Read Committed级别。</p>
<h3 id="1-读未提交-READ-UNCOMMITTED"><a href="#1-读未提交-READ-UNCOMMITTED" class="headerlink" title="1. 读未提交(READ UNCOMMITTED)"></a>1. 读未提交(READ UNCOMMITTED)</h3><p>可以读到其他事务未提交的数据。 </p>
<h3 id="2-读已提交-READ-COMMITTED"><a href="#2-读已提交-READ-COMMITTED" class="headerlink" title="2. 读已提交(READ COMMITTED)"></a>2. 读已提交(READ COMMITTED)</h3><p>只能读到其他事务已提交的数据。 </p>
<h3 id="3-可重复读-REPEATABLE-READ"><a href="#3-可重复读-REPEATABLE-READ" class="headerlink" title="3. 可重复读(REPEATABLE READ)"></a>3. 可重复读(REPEATABLE READ)</h3><p>在读已提交的基础上，增加一点，本条事务内，读同一份数据，以该事务第一次读取的数据的备份为标准（即使在此期间其他事务提交了该数据的修改，读到的仍是原数据）。 </p>
<h3 id="4-串行-SERIALIZABLE"><a href="#4-串行-SERIALIZABLE" class="headerlink" title="4. 串行(SERIALIZABLE)"></a>4. 串行(SERIALIZABLE)</h3><p>串行执行，该事务不能与其他事务同时操作同一个数据，必须等待操作数据的事务或串行事务提交才能继续运行。Serializable的事务先查询或修改了该条记录，则其他事务对该记录的操作均会被阻塞。 </p>
<p>事务隔离会在写数据的时候给数据加上排他锁，而串行事务下读数据的时候也会给数据加上排他锁。 </p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>查看当前事务隔离级别  <code>SELECT @@TX_ISOLATION</code></p>
<p>设置当前事务隔离级别  <code>SET SESSION TRANSACTION ISOLATION LEVEL read uncommitted / read committed / repeatable read / serializable</code></p>
<p>Spring中注解设置 <code>@Transactional(isolation = Isolation.REPEATABLE_READ)</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2018/03/10/transaction-isolation/" data-id="ck3jtblel000pqsuon37g25ff" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spring-autowire-resolver" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/02/25/spring-autowire-resolver/" class="article-date">
  <time datetime="2018-02-25T07:20:10.000Z" itemprop="datePublished">2018-02-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/02/25/spring-autowire-resolver/">SpringMVC自定义配置自动注入对象</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>继承org.springframework.web.method.support.HandlerMethodArgumentResolver的类test.UserArgumentResolver</li>
<li>配置文件配置参数</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:annotation-driven&gt;</span><br><span class="line">    &lt;mvc:argument-resolvers&gt;</span><br><span class="line">    	&lt;bean class=&quot;com.xxx.UserArgumentResolver&quot;/&gt;</span><br><span class="line">    &lt;/mvc:argument-resolvers&gt;</span><br><span class="line">&lt;/mvc:annotation-driven&gt;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2018/02/25/spring-autowire-resolver/" data-id="ck3jtblei000oqsuopj5vi4vt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mysql-worktime" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/22/mysql-worktime/" class="article-date">
  <time datetime="2017-12-22T04:35:33.000Z" itemprop="datePublished">2017-12-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/22/mysql-worktime/">mysql计算两个日期间的工作时长（剔除周末，设定上班时间）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="SQL方法创建"><a href="#SQL方法创建" class="headerlink" title="SQL方法创建"></a>SQL方法创建</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"># 查询时间段内的工作时间函数(剔除周末与非工作时间)</span><br><span class="line"># 参数解释</span><br><span class="line"># _st: 开始时间</span><br><span class="line"># _ed: 结束时间</span><br><span class="line"># _hour1: 工作时间开始小时</span><br><span class="line"># _hour2: 工作时间结束小时</span><br><span class="line"># _minute1: 工作时间开始分钟</span><br><span class="line"># _minute2: 工作时间结束分钟</span><br><span class="line"># 返回工作时间总分钟数</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">CREATE FUNCTION work_minute_sum(_st DATETIME, _ed DATETIME, _hour1 INT, _hour2 INT, _minute1 INT, _minute2 INT) RETURNS INTEGER</span><br><span class="line">BEGIN</span><br><span class="line">    DECLARE _one_week_minute INT DEFAULT 10080;</span><br><span class="line">    DECLARE _one_day_work_minute INT DEFAULT (_hour2 - _hour1) * 60 - _minute1 + _minute2;</span><br><span class="line">    DECLARE _st_hour INT DEFAULT DATE_FORMAT(_st, &apos;%H&apos;);</span><br><span class="line">    DECLARE _ed_hour INT DEFAULT DATE_FORMAT(_ed, &apos;%H&apos;);</span><br><span class="line">    DECLARE _st_minute INT DEFAULT DATE_FORMAT(_st, &apos;%i&apos;);</span><br><span class="line">    DECLARE _ed_minute INT DEFAULT DATE_FORMAT(_ed, &apos;%i&apos;);</span><br><span class="line">    DECLARE _st_week INT DEFAULT DATE_FORMAT(_st, &apos;%w&apos;);</span><br><span class="line">    DECLARE _ed_week INT DEFAULT DATE_FORMAT(_ed, &apos;%w&apos;);</span><br><span class="line">    </span><br><span class="line">    DECLARE _diffminute INT;</span><br><span class="line">    DECLARE _che DATETIME;</span><br><span class="line">    DECLARE _flag INT DEFAULT 1;</span><br><span class="line">    DECLARE _week INT;</span><br><span class="line">    DECLARE _hour_div INT;</span><br><span class="line">    DECLARE _count_week INT DEFAULT 0;</span><br><span class="line">    DECLARE _work_minute INT DEFAULT 0;</span><br><span class="line">    </span><br><span class="line">    IF ((_hour1 &gt; _hour2) || (_hour1 = _hour2 &amp;&amp; _minute1 &gt;= _minute2)) THEN</span><br><span class="line">        RETURN 0;</span><br><span class="line">    END IF;</span><br><span class="line">    IF _st &gt; _ed THEN </span><br><span class="line">        SET _che = _st;</span><br><span class="line">        SET _st = _ed;</span><br><span class="line">        SET _ed = _che;</span><br><span class="line">        SET _flag = -1;</span><br><span class="line">    END IF;</span><br><span class="line"></span><br><span class="line">    SET _diffminute = TIMESTAMPDIFF(MINUTE, _st, _ed);</span><br><span class="line">    SET _count_week = _diffminute / _one_week_minute;</span><br><span class="line">    SET _work_minute = _count_week * 5 * _one_day_work_minute;</span><br><span class="line">    </span><br><span class="line">    SET _st = DATE_ADD(_st, INTERVAL (_count_week * 7) DAY);</span><br><span class="line"></span><br><span class="line">    IF (_st_week = 0 || _st_week = 6) THEN</span><br><span class="line">        SET _work_minute = _work_minute;</span><br><span class="line">    ELSEIF ((_st_hour &gt; _hour2) || (_st_hour = _hour2 &amp;&amp; _st_minute &gt;= _minute2)) THEN</span><br><span class="line">        SET _work_minute = _work_minute - _one_day_work_minute;</span><br><span class="line">	ELSEIF (_st_hour &gt; _hour1) || (_st_hour = _hour1 &amp;&amp; _st_minute &gt; _minute1) THEN</span><br><span class="line">        SET _hour_div = _st_hour - _hour1;</span><br><span class="line">        SET _work_minute = _work_minute - (_hour_div * 60) - _st_minute + _minute1;</span><br><span class="line">    END IF;</span><br><span class="line">    </span><br><span class="line">    IF _ed_week = 0 || _ed_week = 6 || _ed_hour &lt; _st_hour || (_ed_hour = _st_hour &amp;&amp; _ed_minute &lt;= _st_minute) THEN</span><br><span class="line">        SET _work_minute = _work_minute;</span><br><span class="line">    ELSEIF (_ed_hour &lt; _hour1) || (_ed_hour = _hour1 &amp;&amp; _ed_minute &lt; _minute1) THEN</span><br><span class="line">        SET _work_minute = _work_minute - _one_day_work_minute;</span><br><span class="line">    ELSEIF (_ed_hour &lt; _hour2) || (_ed_hour = _hour2 &amp;&amp; _ed_minute &lt; _minute2) THEN</span><br><span class="line">		SET _hour_div = _hour2 - _ed_hour;</span><br><span class="line">        SET _work_minute = _work_minute - (_hour_div * 60) + _ed_minute - _minute2;</span><br><span class="line">    END IF;</span><br><span class="line">    </span><br><span class="line">    loop_cal:LOOP</span><br><span class="line">        SET _week = DATE_FORMAT(_st, &apos;%w&apos;);</span><br><span class="line">        IF _st &gt;= _ed THEN</span><br><span class="line">            LEAVE loop_cal;</span><br><span class="line">        END IF;</span><br><span class="line">        IF _week != 0 &amp;&amp; _week != 6 THEN</span><br><span class="line">		    SET _work_minute = _work_minute + _one_day_work_minute;</span><br><span class="line">        END IF;</span><br><span class="line">        SET _st = DATE_ADD(_st, INTERVAL 1 DAY);</span><br><span class="line">    END LOOP;</span><br><span class="line">    </span><br><span class="line">    RETURN _work_minute * _flag;</span><br><span class="line">END $$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h2 id="调用方法"><a href="#调用方法" class="headerlink" title="调用方法"></a>调用方法</h2><p>#例：某公司工作时间为上午： 09:00 ~ 12:00，下午： 13:30 ~ 18:00，则在2019年3月3日0点到2019年3月13日22点的总工作时间是：<br>select work_minute_sum(‘2019-03-03 00:00:00’, ‘2019-03-13 22:00:00’, 9, 12, 0, 0) + work_minute_sum(‘2019-03-03 00:00:00’, ‘2019-03-13 22:00:00’, 13, 18, 30, 0);</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2017/12/22/mysql-worktime/" data-id="ck3jtblef000mqsuo8xzbjc72" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-css-display" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/30/css-display/" class="article-date">
  <time datetime="2017-09-30T14:42:01.000Z" itemprop="datePublished">2017-09-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/30/css-display/">CSS属性display的inline、block、inline-block的区别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="三种元素解释"><a href="#三种元素解释" class="headerlink" title="三种元素解释"></a>三种元素解释</h2><p>block:：对象为块状元素，整体保持块状状态（矩形形状），并且单独占据一行（同一行内不会有兄弟节点）</p>
<p>inline：对象为行内元素，整体不会一定保持块状状态，并且不会一定单独占据一行，超过一行的部分进入下一行</p>
<p>inline-block：介于block与inline之间，整体保持块状状态，但不会一定单独占据一行</p>
<h2 id="案例解析"><a href="#案例解析" class="headerlink" title="案例解析"></a>案例解析</h2><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;test&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.dsp-demo &#123;</span><br><span class="line">    width: 150px;</span><br><span class="line">    display: inline;</span><br><span class="line">/*    display: block; */</span><br><span class="line">/*    display: inline-block; */</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=&quot;width: 400px;&quot;&gt;</span><br><span class="line">&lt;span class=&quot;dsp-demo&quot; style=&quot;border: 1px solid #ff0;&quot;&gt;</span><br><span class="line">第一个-----------------------------------------------------------------------------------</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">&lt;span class=&quot;dsp-demo&quot; style=&quot;border: 1px solid #0ff;&quot;&gt;</span><br><span class="line">第二个-----------------------------------------------------------------------------------</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">&lt;span class=&quot;dsp-demo&quot; style=&quot;border: 1px solid #f0f;&quot;&gt;</span><br><span class="line">第三个-----------------------------------------------------------------------------------</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="inline元素呈现效果"><a href="#inline元素呈现效果" class="headerlink" title="inline元素呈现效果"></a>inline元素呈现效果</h3><p><img src="../static/MB17093001-1.png" alt="在这里插入图片描述"></p>
<h3 id="block元素呈现效果"><a href="#block元素呈现效果" class="headerlink" title="block元素呈现效果"></a>block元素呈现效果</h3><p><img src="../static/MB17093001-2.png" alt="在这里插入图片描述"></p>
<h3 id="inline-block元素呈现效果"><a href="#inline-block元素呈现效果" class="headerlink" title="inline-block元素呈现效果"></a>inline-block元素呈现效果</h3><p><img src="../static/MB17093001-3.png" alt="在这里插入图片描述"></p>
<h3 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h3><p>如上所示：inline元素的呈现中，注意第一个span的第二行与第一行宽度不相同，并且span的边界跨越了多行（无块状特性），该特性导致设置的width、height属性无效，第二个span接续第一个span继续呈现（不独占一行特性）；block元素的呈现中，span整体为矩形（块状特性），虽然父div有400px的宽度，span仅需150px，理论上一行可存在二个span，但第二个span仍然另起一行显示（独占一行特性）；inline-block元素的呈现中，span整体为矩形（块状特性），一行显示两个span（不独占一行特性）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2017/09/30/css-display/" data-id="ck3jtblec000kqsuogjubmjoe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css/">css</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spring-xml-jackson" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/18/spring-xml-jackson/" class="article-date">
  <time datetime="2017-08-18T10:19:51.000Z" itemprop="datePublished">2017-08-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/18/spring-xml-jackson/">spring基于xml格式数据交换的前后端配置与使用之Jackson方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MappingJackson2XmlHttpMessageConverter方式解析xml（支持注解修改元素别名）配置及代码如下：</p>
<p>xml配置文件中添加converter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean class=&quot;org.springframework.http.converter.xml.MappingJackson2XmlHttpMessageConverter&quot;&gt;</span><br><span class="line">                &lt;property name=&quot;supportedMediaTypes&quot;&gt;</span><br><span class="line">                	&lt;list&gt;</span><br><span class="line">                		&lt;value&gt;application/xml;charset=UTF-8&lt;/value&gt;</span><br><span class="line">                	&lt;/list&gt;</span><br><span class="line">                &lt;/property&gt;</span><br><span class="line">                &lt;property name=&quot;prettyPrint&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">            &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>pom 文件（在原来的基础上添加了jackson-dataformat-xml的依赖，这里jackson为2.8.7版本）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-core&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-core&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;jackson.version&#125;&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>controller文件（这个controller本就是@restcontroller）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;txml&quot;, headers = &#123; &quot;content-type=application/xml;charset=UTF-8&quot;&#125;)</span><br><span class="line">	public Object testXml(@RequestBody Xml xml) &#123;</span><br><span class="line"></span><br><span class="line">                // 这部分主要打印看看，验证request xml方式入参成功</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectMapper mapper = new ObjectMapper();</span><br><span class="line">			mapper.disable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES)</span><br><span class="line">					.enable(JsonGenerator.Feature.IGNORE_UNKNOWN).enable(JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES);</span><br><span class="line">			System.out.println(mapper.writeValueAsString(xml));// 打印入参数据可以看到成功入参</span><br><span class="line">		&#125; catch (JsonProcessingException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">                // response出参数据</span><br><span class="line">		Test_DtoOut tdo = new Test_DtoOut();</span><br><span class="line">		tdo.code = 200;</span><br><span class="line">		tdo.msg = xml.getToUserName();</span><br><span class="line">		return tdo;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>两个出入参dto（只截部分代码）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package com.mufeng.dto.in;</span><br><span class="line"></span><br><span class="line">import com.fasterxml.jackson.annotation.JsonProperty;</span><br><span class="line">import com.fasterxml.jackson.annotation.JsonRootName;</span><br><span class="line"></span><br><span class="line">@JsonRootName(value=&quot;out&quot;) // 给xml根节点别名，不然会带包名</span><br><span class="line">public class Xml &#123;</span><br><span class="line">	@JsonProperty(value=&quot;toUserName&quot;)// 变量对应的入参数据标签名，这里可以使实现与入参数据标签名不同</span><br><span class="line">	String toUserName;</span><br><span class="line">	@JsonProperty(value=&quot;fromUserName&quot;)</span><br><span class="line">	String fromUserName;</span><br><span class="line">	@JsonProperty(value=&quot;CreateTime&quot;)</span><br><span class="line">	Long createTime;</span><br><span class="line">	@JsonProperty(value=&quot;MsgType&quot;)</span><br><span class="line">	String msgType;</span><br><span class="line">	@JsonProperty(value=&quot;Event&quot;)</span><br><span class="line">	String event;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">package com.mufeng.dto.out;</span><br><span class="line"></span><br><span class="line">import com.fasterxml.jackson.annotation.JsonProperty;</span><br><span class="line">import com.fasterxml.jackson.annotation.JsonRootName;</span><br><span class="line">import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlRootElement;</span><br><span class="line"></span><br><span class="line">//@JacksonXmlRootElement(localName=&quot;out&quot;)</span><br><span class="line">@JsonRootName(value=&quot;out&quot;)</span><br><span class="line">public class Test_DtoOut &#123;</span><br><span class="line"></span><br><span class="line">	@JsonProperty(value=&quot;codes&quot;)</span><br><span class="line">	public Integer code;</span><br><span class="line">        // 不给别名xml数据默认的标签名与属性名一致</span><br><span class="line">	public String msg;</span><br></pre></td></tr></table></figure>

<p>前端文件html（注意前端代码要放到服务器上，浏览器输入url，否则contentType不会起作用）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;  </span><br><span class="line">&lt;head&gt;  </span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;application/xml; charset=UTF-8&quot;&gt;  </span><br><span class="line">&lt;title&gt;测试接收XML格式的数据&lt;/title&gt;  </span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;https://code.jquery.com/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;  </span><br><span class="line">&lt;!-- &lt;script type=&quot;text/javascript&quot; src=&quot;js/json2.js&quot;&gt;&lt;/script&gt;  --&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;  </span><br><span class="line">$(document).ready(function()&#123;  </span><br><span class="line">    sendxml();  </span><br><span class="line">&#125;);  </span><br><span class="line">  </span><br><span class="line">function sendxml()&#123;  </span><br><span class="line">    var xmlData = &quot;&lt;out&gt;&lt;toUserName&gt;toUser&lt;/toUserName&gt;&lt;fromUserName&gt;FromUser&lt;/fromUserName&gt;&lt;CreateTime&gt;123456789&lt;/CreateTime&gt;&lt;MsgType&gt;event&lt;/MsgType&gt;&lt;Event&gt;subscribe&lt;/Event&gt;&lt;/out&gt;&quot;;</span><br><span class="line">   </span><br><span class="line">	$.ajax(&#123;</span><br><span class="line">            type: &quot;POST&quot;,</span><br><span class="line">            url: &quot;http://localhost:8080/valida/webctrl/demo/txml&quot;,</span><br><span class="line">                </span><br><span class="line">                // data sent is xml</span><br><span class="line">				contentType: &quot;application/xml; charset=utf-8&quot;,</span><br><span class="line">                data: xmlData, </span><br><span class="line">                // data in response will expected xml</span><br><span class="line">                dataType: &quot;xml&quot;,</span><br><span class="line">				processData: false,</span><br><span class="line">                anysc: false,</span><br><span class="line">				beforeSend: function(request) &#123;</span><br><span class="line">						</span><br><span class="line">                       request.setRequestHeader(&apos;Access-Control-Allow-Origin: *&apos;);</span><br><span class="line">					   request.setRequestHeader(&apos;Access-Control-Allow-Methods: POST,GET,OPTIONS&apos;);</span><br><span class="line">					   request.overrideMimeType(&apos;application/xml; charset=utf-8&apos;)</span><br><span class="line">					   console.log(JSON.stringify(request));</span><br><span class="line">                 &#125;,</span><br><span class="line">                success: function (result) &#123; </span><br><span class="line">					console.log(result);</span><br><span class="line">                &#125;,</span><br><span class="line">                error: function (XMLHttpRequest, textStatus, errorThrown) &#123;</span><br><span class="line">                    alert(errorThrown + &apos;:&apos; + textStatus); // 错误处理</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">		</span><br><span class="line">&#125;  </span><br><span class="line">&lt;/script&gt;  </span><br><span class="line">&lt;/head&gt;  </span><br><span class="line">&lt;body&gt;  </span><br><span class="line">&lt;/body&gt;  </span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>后端控制台打印</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;toUserName&quot;:&quot;toUser&quot;,&quot;fromUserName&quot;:&quot;FromUser&quot;,&quot;CreateTime&quot;:123456789,&quot;MsgType&quot;:&quot;event&quot;,&quot;Event&quot;:&quot;subscribe&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>前端接收到返回值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;out&gt;&lt;msg&gt;toUser&lt;/msg&gt;&lt;codes&gt;200&lt;/codes&gt;&lt;/out&gt;</span><br></pre></td></tr></table></figure>

<p>另外一种使用xstream实现xml数据交换的配置，详见另一篇博客<br><a href="./2017-08-18_spring_xml_xstream.md">spring基于xml格式数据交换的前后端配置与使用之xstream方式</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2017/08/18/spring-xml-jackson/" data-id="ck3jtbld5000aqsuo65hfsvt4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-spring-xml-xstream" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/18/spring-xml-xstream/" class="article-date">
  <time datetime="2017-08-18T10:07:42.000Z" itemprop="datePublished">2017-08-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/18/spring-xml-xstream/">spring基于xml格式数据交换的前后端配置与使用之xstream方式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MarshallingHttpMessageConverter 方式解析xml（支持注解修改元素别名）配置及代码如下：</p>
<p>xml配置文件中添加converter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean class=&quot;org.springframework.http.converter.xml.MarshallingHttpMessageConverter&quot;&gt;</span><br><span class="line">		        &lt;constructor-arg&gt;</span><br><span class="line">		        	&lt;bean class=&quot;org.springframework.oxm.xstream.XStreamMarshaller&quot;&gt;</span><br><span class="line">				        &lt;property name=&quot;streamDriver&quot;&gt;</span><br><span class="line">				            &lt;bean class=&quot;com.thoughtworks.xstream.io.xml.StaxDriver&quot;/&gt;</span><br><span class="line">				        &lt;/property&gt;</span><br><span class="line">				        &lt;property name=&quot;annotatedClasses&quot;&gt;</span><br><span class="line">				            &lt;list&gt;</span><br><span class="line">				                &lt;value&gt;com.mufeng.dto.in.Xml&lt;/value&gt;</span><br><span class="line">				                &lt;value&gt;com.mufeng.dto.out.TestDtoOut&lt;/value&gt;</span><br><span class="line">				            &lt;/list&gt;</span><br><span class="line">				        &lt;/property&gt;</span><br><span class="line">				    &lt;/bean&gt;</span><br><span class="line">				    </span><br><span class="line">		        &lt;/constructor-arg&gt;</span><br><span class="line">		        &lt;property name=&quot;supportedMediaTypes&quot;&gt;</span><br><span class="line">                	&lt;list&gt;</span><br><span class="line">                		&lt;value&gt;application/xml;charset=UTF-8&lt;/value&gt;</span><br><span class="line">                		&lt;value&gt;text/xml;charset=UTF-8&lt;/value&gt;</span><br><span class="line">                		&lt;value&gt;text/html;charset=UTF-8&lt;/value&gt;</span><br><span class="line">                	&lt;/list&gt;</span><br><span class="line">                &lt;/property&gt;</span><br><span class="line">			&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<p>pom文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- xstream xml start --&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;xstream&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;1.4.10&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-oxm&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;4.3.7.RELEASE&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;!-- xstream xml end --&gt;</span><br></pre></td></tr></table></figure>

<p>controller文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;txml&quot;, headers=&#123;&quot;content-type=application/xml&quot;&#125;)</span><br><span class="line">	public Object testXml(@RequestBody Xml xml/*, HttpServletRequest req*/) &#123;</span><br><span class="line">                // 这部分主要打印看看，验证request xml方式入参成功</span><br><span class="line">		try &#123;</span><br><span class="line">			ObjectMapper mapper = new ObjectMapper();</span><br><span class="line">			mapper.disable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES)</span><br><span class="line">					.enable(JsonGenerator.Feature.IGNORE_UNKNOWN).enable(JsonParser.Feature.ALLOW_UNQUOTED_FIELD_NAMES);</span><br><span class="line">			System.out.println(mapper.writeValueAsString(xml));// 打印入参数据可以看到成功入参</span><br><span class="line">		&#125; catch (JsonProcessingException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">                // response出参数据</span><br><span class="line">		TestDtoOut tdo = new TestDtoOut();</span><br><span class="line">		tdo.code = 200;</span><br><span class="line">		tdo.msg = &quot;&quot;;//xml.getToUserName();</span><br><span class="line">		return tdo;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>两个出入参dto（只截部分代码）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package com.mufeng.dto.in;</span><br><span class="line"></span><br><span class="line">import com.thoughtworks.xstream.annotations.XStreamAlias;</span><br><span class="line"></span><br><span class="line">@XStreamAlias(value=&quot;xml&quot;)// 给根节点别名，不然标签名会带上包名</span><br><span class="line">public class Xml &#123;</span><br><span class="line">	@XStreamAlias(value=&quot;ToUserName&quot;)// 给属性别名，可以使实现xml标签名与属性名不同的需求</span><br><span class="line">	String toUserName;</span><br><span class="line">	String FromUserName;// 不给别名，默认标签名与属性名一致</span><br><span class="line">	Long CreateTime;</span><br><span class="line">	String MsgType;</span><br><span class="line">	Long MsgId;</span><br><span class="line">	String Content;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package com.mufeng.dto.out;</span><br><span class="line"></span><br><span class="line">import com.thoughtworks.xstream.annotations.XStreamAlias;</span><br><span class="line"></span><br><span class="line">@XStreamAlias(value=&quot;testDtoOut&quot;)</span><br><span class="line">public class TestDtoOut &#123;</span><br><span class="line"></span><br><span class="line">	public Integer code;</span><br><span class="line">	public String msg;</span><br></pre></td></tr></table></figure>

<p>前端文件html</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  var xmlData = &quot;&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1348831860&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;&lt;Content&gt;&lt;![CDATA[this is a test]]&gt;&lt;/Content&gt;&lt;MsgId&gt;1234567890123456&lt;/MsgId&gt;&lt;/xml&gt;&quot;;</span><br><span class="line"></span><br><span class="line">var xmlhttp;</span><br><span class="line">function loadXMLDoc(url)</span><br><span class="line">&#123;</span><br><span class="line">xmlhttp=null;</span><br><span class="line">if (window.XMLHttpRequest)</span><br><span class="line">  &#123;// all modern browsers</span><br><span class="line">  xmlhttp=new XMLHttpRequest();</span><br><span class="line">  &#125;</span><br><span class="line">else if (window.ActiveXObject)</span><br><span class="line">  &#123;// for IE5, IE6</span><br><span class="line">  xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">if (xmlhttp!=null)</span><br><span class="line">  &#123;</span><br><span class="line">  xmlhttp.onreadystatechange=state_Change;</span><br><span class="line">  xmlhttp.open(&quot;POST&quot;,url,true);</span><br><span class="line">  xmlhttp.setRequestHeader(&quot;Accept&quot;,&quot;application/xml&quot;); </span><br><span class="line">  xmlhttp.setRequestHeader(&quot;Content-Type&quot;,&quot;application/xml&quot;); </span><br><span class="line">  xmlhttp.send(xmlData);</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">  &#123;</span><br><span class="line">  alert(&quot;Your browser does not support XMLHTTP.&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function state_Change()</span><br><span class="line">&#123;</span><br><span class="line">if (xmlhttp.readyState==4)</span><br><span class="line">  &#123;// 4 = &quot;loaded&quot;</span><br><span class="line">  if (xmlhttp.status==200)</span><br><span class="line">    &#123;// 200 = &quot;OK&quot;</span><br><span class="line">    document.getElementById(&apos;p1&apos;).innerHTML=&quot;This file was last modified on: &quot; + xmlhttp.getResponseHeader(&apos;Last-Modified&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">  else</span><br><span class="line">    &#123;</span><br><span class="line">    alert(&quot;Problem retrieving data:&quot; + xmlhttp.statusText);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;p id=&quot;p1&quot;&gt;</span><br><span class="line">The getResponseHeader() function returns a header from a resource.</span><br><span class="line">Headers contain file information like length,</span><br><span class="line">server-type, content-type, date-modified, etc.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;button onclick=&quot;loadXMLDoc(&apos;http://localhost:8080/valida/webctrl/demo/txml&apos;)&quot;&gt;Get &quot;Last-Modified&quot;&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>另外一种使用jackson实现xml数据交换的配置，详见另一篇博客</p>
<p><a href="./2017-08-18_spring_xml_jackson.md">spring基于xml格式数据交换的前后端配置与使用之Jackson方式</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://www.uetty.com/2017/08/18/spring-xml-xstream/" data-id="ck3jtble9000jqsuogpoflfad" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/">spring</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDE/">IDE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyBatis/">MyBatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/">RabbitMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/api/">api</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j/">log4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/open-source/">open source</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vulnerability/">vulnerability</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/IDE/" style="font-size: 10px;">IDE</a> <a href="/tags/MyBatis/" style="font-size: 10px;">MyBatis</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/api/" style="font-size: 10px;">api</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/linux/" style="font-size: 17.5px;">linux</a> <a href="/tags/log4j/" style="font-size: 10px;">log4j</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/mysql/" style="font-size: 12.5px;">mysql</a> <a href="/tags/open-source/" style="font-size: 10px;">open source</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/vulnerability/" style="font-size: 10px;">vulnerability</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">2019-11</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">2019-08</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">2019-07</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">2019-06</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">2019-05</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">2019-04</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">2019-03</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">2019-02</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">2018-12</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">2018-11</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">2018-10</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">2018-09</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">2018-08</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">2018-06</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">2018-03</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">2018-02</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">2017-12</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">2017-09</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">2017-08</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">2017-07</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">2017-05</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">2017-03</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/11/29/2019-11-25_Linux_Cgroup/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/08/15/log4j/">log4j xml配置文件个人配置如何不污染GIT远程仓库</a>
          </li>
        
          <li>
            <a href="/2019/07/31/common-excel/">阿里Easy Excel自定义样式注解</a>
          </li>
        
          <li>
            <a href="/2019/07/29/compare-list-vertor-cowlist/">ArrayList、Vector、CopyOnWriteArrayList对比</a>
          </li>
        
          <li>
            <a href="/2019/07/17/java-garbage-collector/">JAVA垃圾收集器科普</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 Vince<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>